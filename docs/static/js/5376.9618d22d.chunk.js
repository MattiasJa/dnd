"use strict";(self.webpackChunkhack2503=self.webpackChunkhack2503||[]).push([[2649,4673,5376,8546],{5588:(e,t,s)=>{s.d(t,{BB:()=>o,GP:()=>l,Tz:()=>i});const o=window.requestIdleCallback||function(e){return setTimeout((()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50)})}),50)},l=window.cancelIdleCallback||clearTimeout;function i(e){let t,s,i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return function(){const n=arguments,a=()=>{t=null,i=e(...n)};return"idle"===r?(s&&l(s),s=o((()=>{i=e(...n)}))):(clearTimeout(t),t=setTimeout(a,r)),i}}},7644:(e,t,s)=>{s.d(t,{z:()=>o});const o=e=>class extends e{dispatch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const l=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:this).dispatchEvent(new CustomEvent(e,{bubbles:!0,composed:!0,cancelable:!0,detail:t}));return l&&s?s():o&&o(),l}}},10431:(e,t,s)=>{s.d(t,{K:()=>o});const o=e=>class extends e{constructor(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];super(t),this._animationFrame=null,this._callback=this._callback.bind(this)}connectedCallback(){super.connectedCallback(),null===this._resizeObserverElem()&&this._installResizeObserver(this)}disconnectedCallback(){super.disconnectedCallback(),this._uninstallResizeObserver(this)}_installResizeObserver(e){if(this._resizeObserver=new ResizeObserver(this._callback),this._resizeObserver.observe(e),new Set(["inline","contents"]).has(window.getComputedStyle(e).display))throw new Error("ResizeObserver do nothing on inline elements")}_uninstallResizeObserver(e){this._resizeObserver&&(this._resizeObserver.unobserve(e),this._resizeObserver.disconnect())}_resizeObserverElem(){return null}_callback(e){this._animationFrame||(this._animationFrame=window.requestAnimationFrame((()=>{this._animationFrame=null,this._resizeObserverCallback(e)})))}}},13857:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});const o=(0,s(80129).p)({name:"arrowSort",data:'<svg fill="currentColor" viewBox="0 0 24 24"><path d="m17.82 9.846-5.808 5.82-5.808-5.82z"/></svg>'})},32455:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});const o=(0,s(80129).p)({name:"variableHeader",data:'<svg fill="currentColor" viewBox="0 0 24 24"><path d="M16.158 17.13h-2.112v-4.386H9.93v4.386H7.818V6.894H9.93v4.146h4.116V6.894h2.112z"/></svg>'})},32995:(e,t,s)=>{s.r(t),s.d(t,{SortOrder:()=>a,Spreadsheet:()=>ie,SpreadsheetColumn:()=>g,SpreadsheetEvent:()=>c,SpreadsheetSlot:()=>l,headerDataRowIndex:()=>i,metaDataRowIndex:()=>r,noCell:()=>w});var o=s(5298);var l;!function(e){e.HEADER_SLOT="header",e.TOOLBAR_SLOT="toolbar-slot"}(l||(l={}));const i=-1,r=-2,n="2.0.259";var a;!function(e){e[e.Unset=0]="Unset",e[e.Descending=1]="Descending",e[e.Ascending=2]="Ascending"}(a||(a={}));var c;!function(e){e.Select="select",e.Sort="sort",e.Remove="remove",e.Header="header",e.Change="change",e.ColumnnHeader="column-header",e.EditBegin="edit-begin",e.EditEnd="edit-end",e.CellMouseEnter="cell-mouse-enter",e.CellMouseLeave="cell-mouse-leave"}(c||(c={}));var d,h=s(13857),u=s(52562),_=function(e,t,s,o){var l,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(r=(i<3?l(r):i>3?l(t,s,r):l(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let g=d=class extends o.OC{constructor(){super(),this.index=1,this.secondary=!1,this.selectable=!1,this.selectedColumn=!1,this.selectedCellOnColumn=!1,this.firstSelectedColumn=!1,this.lastSelectedColumn=!1,this.selectedCell=!1,this.hoverColumn=!1,this.last=!1,this.sortable=!1,this.sortOrder=a.Unset,this.showIndex=!1,this._isEdit=!1,this._sortClickHandler=this._sortClickHandler.bind(this)}connectedCallback(){this.style.setProperty("display","none");const e=[];e.push({module:()=>s.e(6930).then(s.bind(s,66930)),elem:["EllipsingTitle"]}),e.push({module:()=>s.e(9693).then(s.bind(s,59693)),elem:["Icon"]}),d.dynSubRegister(e,(()=>{super.connectedCallback(),this.style.removeProperty("display")}))}focus(){this._title&&this._title.focus()}firstUpdated(e){this._setupSortEventhandler(),super.firstUpdated(e)}update(e){if(e.has("editable")){const e=this.shadowRoot.querySelector("div");e&&(this.editable?e.style.setProperty("--fixed-width",`${e.getBoundingClientRect().width}px`):e.style.removeProperty("--fixed-width"))}super.update(e)}updated(e){(e.has("sortable")||e.has("label")||e.has("editable"))&&this._setupSortEventhandler(),super.updated(e)}render(){const[e,t]=(0,o.Yh)(this.tagName.toLowerCase(),{secondary:this.secondary,"selected-column":this.selectedColumn,"selected-cell-on-column":this.selectedCellOnColumn,"hover-column":this.hoverColumn&&this.selectable,selectable:this.selectable,sortable:this.sortable,sorted:this.sortOrder!==a.Unset,editing:this._isEdit}),s=this.label?o.qy`
                <${d.EllipsingTitle.tag} class="${e}-title" .label='${this.label}'
                                                         ?editable='${this.editable&&!this.disabled}'
                                                         @title-focus=${()=>this._isEdit=!0}
                                                         @title-blur=${()=>this._isEdit=!1}>
                    ${this._renderSortIndicator()}
                </${d.EllipsingTitle.tag}>`:o.qy` <slot></slot>`,l=this.subLabel?o.qy`
                <${d.EllipsingTitle.tag} class="${e}-subtitle" .label='${this.subLabel}'>
                </${d.EllipsingTitle.tag}>`:null,i=this.icon?o.qy`
                <${d.Icon.tag} class="${e}-icon"
                                               icon='${this.icon}'></${d.Icon.tag}>`:null,r=this.showIndex?this._renderIndex(e):o.qy`
                  <div class="${e}-container">
                      <div class="${e}-title-container">${s} ${l}</div>
                      ${i}
                  </div>
                  <slot name="column-head"></slot>
              `;return o.qy` <div class="${t}">${r}</div> `}_setupSortEventhandler(){this._title&&(this.sortable&&!this.editable?this._title.addEventListener("mousedown",this._sortClickHandler):this._title.removeEventListener("mousedown",this._sortClickHandler))}_renderSortIndicator(){if(this.sortable&&!this.editable){let e="unset";this.sortOrder===a.Ascending?e="asc":this.sortOrder===a.Descending&&(e="desc");const t=o.qy`
                <${d.Icon.tag} icon='${"unset"===e?u.default:h.default}'></${d.Icon.tag}>`;return o.qy` <div slot="left-slot" class=${"sort-indicator "+e}>${t}</div> `}return null}_renderIndex(e){return o.qy`
            <div class="${e}-index">
                <slot />
            </div>
        `}_sortClickHandler(e){e.stopPropagation(),e.preventDefault(),this.sortOrder=(this.sortOrder+1)%3;const t={column:this.index,order:this.sortOrder};this.dispatchEvent(new CustomEvent(c.Sort,{bubbles:!0,composed:!0,cancelable:!0,detail:{value:t}}))}};_([(0,o.MZ)({type:String,reflect:!1}),p("design:type",Object)],g.prototype,"label",void 0),_([(0,o.MZ)({type:String,reflect:!1}),p("design:type",Object)],g.prototype,"subLabel",void 0),_([(0,o.MZ)({type:String,reflect:!1}),p("design:type",Object)],g.prototype,"icon",void 0),_([(0,o.MZ)({type:Number,reflect:!0}),p("design:type",Object)],g.prototype,"index",void 0),_([(0,o.MZ)({type:Boolean,converter:o.Bs}),p("design:type",Object)],g.prototype,"secondary",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs,attribute:"selectable"}),p("design:type",Object)],g.prototype,"selectable",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs,attribute:"selected-column"}),p("design:type",Object)],g.prototype,"selectedColumn",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs,attribute:"selected-cell-on-column"}),p("design:type",Object)],g.prototype,"selectedCellOnColumn",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs,attribute:"first-selected-column"}),p("design:type",Object)],g.prototype,"firstSelectedColumn",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs,attribute:"last-selected-column"}),p("design:type",Object)],g.prototype,"lastSelectedColumn",void 0),_([(0,o.MZ)({type:Boolean,converter:o.Bs,attribute:"selected-cell"}),p("design:type",Object)],g.prototype,"selectedCell",void 0),_([(0,o.MZ)({type:Boolean,converter:o.Bs,attribute:"hover-column"}),p("design:type",Object)],g.prototype,"hoverColumn",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),p("design:type",Object)],g.prototype,"last",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),p("design:type",Object)],g.prototype,"sortable",void 0),_([(0,o.MZ)({type:Number,attribute:"sort-order",reflect:!0}),p("design:type",Object)],g.prototype,"sortOrder",void 0),_([(0,o.MZ)({type:Boolean,attribute:"show-index",converter:o.Bs}),p("design:type",Object)],g.prototype,"showIndex",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),p("design:type",Object)],g.prototype,"editable",void 0),_([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),p("design:type",Object)],g.prototype,"disabled",void 0),_([(0,o.P)('[class$="-title"]'),p("design:type",Object)],g.prototype,"_title",void 0),_([(0,o.wk)(),p("design:type",Object)],g.prototype,"_isEdit",void 0),g=d=_([(0,o.eV)({tagName:"spreadsheet-column",styles:e=>{const{root:t,child:s,is:l}=(0,o.zz)(e);return[o.AH`:host,:host::before,:host::after,:host *,:host *::before,:host *::after{box-sizing:border-box;}:host{display:table-cell;border-left:1px solid var(--color-secondary-3);border-top:1px solid var(--color-secondary-3);border-bottom:var(--color-line, 1px solid ${(0,o.b7)("color_secondary_3")});position:relative;text-overflow:ellipsis;}:host([last]){border-right:1px solid ${(0,o.b7)("color_secondary_3")};}:host([show-index]){border-bottom:0;height:24px;vertical-align:middle;}:host([secondary]){text-align:center;vertical-align:middle;border-top:none;}:host([selected-column]):after,:host([selected-row]):after,:host([selected-cell]):after{content:' ';display:block;position:absolute;pointer-events:none;inset:-1px;z-index:1;}:host(:focus-visible){outline:2px solid black;outline-offset:-2px;}${l("sortable")} ${s("title")}{cursor:pointer;}:host([selected-cell]):after{border-top:2px solid ${(0,o.b7)("color_secondary_10")};}:host([selected-cell]:not([selected-row-below])):after{border-bottom:2px solid ${(0,o.b7)("color_secondary_10")};}:host([selected-cell-first]):after{border-left:2px solid ${(0,o.b7)("color_secondary_10")};}:host([selected-cell-last]):after{border-right:2px solid ${(0,o.b7)("color_secondary_10")};}:host([first-selected-column]:not([selected-row]):not([show-index])):after{border-left:1px solid ${(0,o.b7)("color_secondary_10")};}:host([last-selected-column]:not([selected-row]):not([show-index])):after{border-right:1px solid ${(0,o.b7)("color_secondary_10")};}:host([selected-column][show-index]):after{border-bottom:1px solid ${(0,o.b7)("color_secondary_10")};}:host([index='-1']){--spreadsheet-column-width:initial;--spreadsheet-column-min-width:initial;--spreadsheet-column-max-width:initial;width:1%;border-left:0;padding:4px 8px;background:${(0,o.b7)("color_secondary_1")};vertical-align:middle;}:host([index='-1'][selected-cell-on-row]),:host([index='-1'][selected-row]){background:var(--spreadsheet-selection-index-bg-color);}:host([selected-row]:not([selected-column])):after{border-top:1px solid ${(0,o.b7)("color_secondary_10")};}:host([selected-row]:not([selected-column]):not([selected-row-below])):after{border-bottom:1px solid ${(0,o.b7)("color_secondary_10")};}:host([index='-1'][selected-row]):after{border-left:1px solid ${(0,o.b7)("color_secondary_10")};left:0;}:host([selected-row][last]):after{border-right:1px solid ${(0,o.b7)("color_secondary_10")};}:host([secondary][selected-row]):after{border-top:1px solid ${(0,o.b7)("color_secondary_10")};top:0;}:host([index='0']){border-left:1px solid transparent;}:host([show-index]){background:${(0,o.b7)("color_secondary_1")};color:var(--spreadsheet-index-color);}:host([show-index][disabled]){color:${(0,o.b7)("color_secondary_4")};}:host([show-index][selected-column]){color:var(--spreadsheet-full-selection-index-fg-color);}:host([show-index][selected-column]){background-color:var(--spreadsheet-full-selection-index-bg-color);}:host([show-index][selected-cell-on-column]){background-color:var(--spreadsheet-selection-index-bg-color);}:host(:not([index='-1'])){width:var(--spreadsheet-column-width, initial);min-width:var(--spreadsheet-column-min-width, initial);max-width:var(--spreadsheet-column-max-width, initial);}.sort-indicator{display:grid;place-items:center;transition:transform 0.4s;width:16px;height:20px;transform:rotate(0deg);}.sort-indicator.asc{transition:transform 0.4s;transform:rotate(180deg);}.sort-indicator.unset{visibility:hidden;}${l("sortable")} ${s("title")}:hover .sort-indicator.unset{visibility:visible;}${t}{display:flex;justify-content:space-between;align-items:center;width:var(--fixed-width, var(--spreadsheet-column-width, initial));min-width:var(--fixed-width, var(--spreadsheet-column-width, initial));flex-direction:column;padding:4px 8px var(--color-pad, 4px) 8px;overflow:hidden;}${l("sorted")} ${s("ellipse")}{padding-right:0;}:host([index='-1']) ${t}{width:initial;padding:0;}:host([show-index]) ${t}{padding:0;width:100%;}${s("container")}{display:flex;flex-direction:row;width:100%;align-items:center;}${s("title-container")}{display:flex;flex-direction:column;width:100%;align-items:start;font-weight:var(--spreadsheet-head-title-weight, normal);}${s("title")}{margin:0;width:100%;text-align:left;}${l("editing")} ${s("title")}{position:absolute;inset:0;padding-left:8px;padding-right:8px;}${s("subtitle")}{margin:0;width:100%;font-size:14px;color:var(--color-secondary-8);text-align:left;}${l("editing")} ${s("subtitle")}{visibility:hidden;}${l("editing")} ${s("icon")}{visibility:hidden;}${s("index")}{width:100%;text-align:center;font-size:16px;}:host([hover-column][selectable]){background-color:#0000001a;}:host([hover-column][selectable][show-index]){background-color:#cecece;}:host([hover-column][selected-column][selectable][show-index]){background-color:#cecece;}`]},version:n}),p("design:paramtypes",[])],g);var f=s(32455);const m=-1,b=-2,v=-1,w=[b,b],C=[v,0],y=e=>e[0],x=e=>e[1],S=(e,t)=>y(e)===y(t)&&x(e)===x(t),$=e=>S(e,w),R=e=>(e.sort(((e,t)=>e[0]-t[0]||e[1]-t[1])),e),k=e=>(e.sort(((e,t)=>e[1]-t[1]||e[0]-t[0])),e);class M{constructor(e,t){if(this.from=()=>this.f,this.to=()=>this.t,this.min=()=>this.c1,this.max=()=>this.c2,t){const s=R([e,t]),o=k([e,t]);this.c1=[s[0][0],o[0][1]],this.c2=[s[1][0],o[1][1]],this.f=e,this.t=t}else this.c1=e,this.c2=e,this.f=e,this.t=e}contains(e){return this.c1[0]<=e[0]&&e[0]<=this.c2[0]&&this.c1[1]<=e[1]&&e[1]<=this.c2[1]}size(){return(this.c2[0]+1-this.c1[0])*(this.c2[1]+1-this.c1[1])}forEach(e,t){let s=0;for(let o=this.c1[0];o<=this.c2[0];++o){let l=0;for(let t=this.c1[1];t<=this.c2[1];++t)e([o,t],[s,l]),++l;t&&t(o,s),++s}}}function E(e){e.stopPropagation(),e.preventDefault()}function T(e,t){return void 0!==e&&void 0===t?1:void 0!==t&&void 0===e?-1:void 0===e&&void 0===t?0:e>t?1:e<t||"number"===typeof e&&"string"===typeof t?-1:"string"===typeof e&&"number"===typeof t?1:0}function I(e,t,s,o,l){if(l>9)return o(null);{const i=e.querySelector(t);if(null!==i)return s(i);setTimeout((function(){I(e,t,s,o,l+1)}),100)}}function A(e,t){return new Promise(((s,o)=>{I(e,t,s,o,0)}))}const O=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return Math.abs(e-t)<s},H=(e,t,s)=>(void 0===t||O(e.scrollTop,t))&&(void 0===s||O(e.scrollLeft,s));const B=e=>Object.entries(e).filter((e=>{let[t,s]=e;return t&&s})).map((e=>{let[t,s]=e;return`${t}: ${s};`})).join("");var z=s(45901),D=s(5588),L=s(7644),F=s(10431),W=function(e,t,s,o){var l,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(r=(i<3?l(r):i>3?l(t,s,r):l(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},j=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const N=e=>{class t extends((0,F.K)(e)){constructor(){for(var e=arguments.length,s=new Array(e),o=0;o<e;o++)s[o]=arguments[o];super(s),this.noVirtualization=!1,this.extraVirtualized=5,this.scrollbar=null,this.rowBuffer=5e5,this.colBuffer=6e4,this._virtualizationCacheRow=t._virtalizationDefaults,this._virtualizationCacheCol=t._virtalizationDefaults,this._virtualizationCacheRowDimension=0,this._virtualizationCacheColDimension=0,this._scrollTicking=null,this._scroll=null,this._isVrtualizerEnabled=()=>!this.noVirtualization,this._getRowSpan=()=>this._isRowVirtualizationEnabled()?{start:this._virtualizationCacheRow.startWithExtra,end:null!==this._virtualizationCacheRow.endWithExtra?this._virtualizationCacheRow.endWithExtra+1:this.getBoundingClientRect().height/this._rowHeight()}:{start:-1,end:-1},this._getColSpan=()=>this._isColVirtualizationEnabled()?{start:this._virtualizationCacheCol.startWithExtra,end:null!==this._virtualizationCacheCol.endWithExtra?this._virtualizationCacheCol.endWithExtra+1:this.getBoundingClientRect().width/this._columnWidth()}:{start:-1,end:-1},this._colsKey=e=>this._virtualizationCacheCol.startWithExtra+e,this._rowsKey=e=>this._virtualizationCacheRow.startWithExtra+e,this._installScrollResizeObserver=()=>{this._scroll&&(this._uninstallResizeObserver(this),this._installResizeObserver(this._scroll))},this._isColVirtualizationEnabled=()=>this._columnWidth()>9&&!this.noVirtualization&&this._dataColLength()>t.VIRTUALIZATION_MIN_COL_LEN,this._isRowVirtualizationEnabled=()=>!this.noVirtualization&&this._dataRowLength()>t.VIRTUALIZATION_MIN_ROW_LEN,this._updateScrollbar=()=>{this._scroll&&(this._uninstallResizeObserver(this._scroll),this._scroll.removeEventListener("scroll",(e=>this._onScrollCallback(e)))),this._scroll=this.scrollbar,this._installResizeObserver(this._scroll),this._scroll.addEventListener("scroll",(e=>this._onScrollCallback(e)))},this._calcVirtualizedStartingRow=()=>{const e=this._dataRowLength()>this.rowBuffer?this._dataRowLength()/this.rowBuffer:1,t=this._scroll?Math.round(e*this._scroll.scrollTop/this._rowHeight()):0;return Math.min(Math.max(t,0),this._dataRowLength())},this._calcVirtualizedEndingRow=e=>Math.round(e/this._rowHeight()),this._calcVirtualizedStartingCol=()=>{const e=this._dataColLength()>this.colBuffer?this._dataColLength()/this.colBuffer:1,t=this._scroll?Math.round(e*this._scroll.scrollLeft/this._columnWidth()):0;return Math.max(t,0)},this._calcVirtualizedEndingCol=e=>Math.round(e/this._columnWidth()),this._onScrollCallback=this._onScrollCallback.bind(this),this._measure=this._measure.bind(this)}_getScroller(){return this.scrollbar}firstUpdated(e){var t,s;super.firstUpdated(e),this._scroll||(this._scroll=this.scrollbar?this.scrollbar:null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector('[class$="-scroll"]'),this._installScrollResizeObserver()),null===(s=this._scroll)||void 0===s||s.addEventListener("scroll",(e=>this._onScrollCallback(e)))}willUpdate(e){void 0!==e.get("scrollbar")&&this._updateScrollbar()}updated(e){var t;super.updated(e);if(void 0!==e.get("_virtualizationCacheCol")){const e=this._virtualizationCacheCol.startWithExtra;this._columnsAppear((null!==(t=this._virtualizationCacheCol.endWithExtra)&&void 0!==t?t:0)-e+1,e)}}_resizeObserverCallback(e){this._debouncedCallback||(this._debouncedCallback=(0,D.Tz)((e=>this._measure(e)),"idle")),this._debouncedCallback(e[0])}_onScrollCallback(e){if(!this._scrollTicking){const t=this._isRowVirtualizationEnabled(),s=this._isColVirtualizationEnabled();this._scrollTicking=window.requestAnimationFrame((()=>{this._scrollTicking=null,s&&this._scrollCols(),t&&this._scrollRows(),this._scrollOccured(e.target)}))}}_scrollRows(){const e=this._calcVirtualizedStartingRow();if(e>=this._virtualizationCacheRow.start+this.extraVirtualized-1||e<=this._virtualizationCacheRow.start-this.extraVirtualized+1){const t=this._virtualizationCacheRow.end||this._calcVirtualizedEndingRow(this._virtualizationCacheRowDimension);this._doRowCalculation(e,t,this._dataRowLength(),this._virtualizationCacheRowDimension)}}_scrollCols(){const e=this._calcVirtualizedStartingCol();if(e>=this._virtualizationCacheCol.start+this.extraVirtualized-1||e<=this._virtualizationCacheCol.start-this.extraVirtualized+1){const t=this._virtualizationCacheCol.end||this._calcVirtualizedEndingCol(this._virtualizationCacheColDimension);this._doColCalculation(e,t,this._dataColLength(),this._virtualizationCacheColDimension)}}_measure(e){const t=this._isRowVirtualizationEnabled(),s=this._isColVirtualizationEnabled(),o=this._rootElement(),l=e.contentRect.width,i=e.contentRect.height;if(s){const e=this._dataColLength();this._doColCalculation(this._calcVirtualizedStartingCol(),this._calcVirtualizedEndingCol(l),e,l)}else o.style.removeProperty("--extra-col-start-width"),o.style.removeProperty("--extra-col-end-width");if(t){const e=this._dataRowLength();this._doRowCalculation(this._calcVirtualizedStartingRow(),this._calcVirtualizedEndingRow(i),e,i)}else o.style.removeProperty("--extra-row-start-height"),o.style.removeProperty("--extra-row-end-height");this._resizeOccured(l,i)}_doRowCalculation(e,t,s,o){const l=Math.max(e-this.extraVirtualized,0),i=Math.min(e+t+this.extraVirtualized,s-1),r=l*this._rowHeight(),n=(s-i-1)*this._rowHeight();this._virtualizationCacheRow.start===e&&this._virtualizationCacheRow.end===t||(this._virtualizationCacheRow={start:e,end:t,startWithExtra:l,endWithExtra:i}),o!==this._virtualizationCacheRowDimension&&(this._virtualizationCacheRowDimension=o);const a=this._dataRowLength()>this.rowBuffer?this.rowBuffer/this._dataRowLength():1,c=this._rootElement();c.style.setProperty("--extra-row-start-height",`${Math.max(r*a,0)}px`),c.style.setProperty("--extra-row-end-height",`${Math.max(n*a,0)}px`)}_doColCalculation(e,t,s,o){const l=Math.max(e-this.extraVirtualized,0),i=Math.min(e+t+this.extraVirtualized,s-1),r=l*this._columnWidth(),n=(s-i-1)*this._columnWidth();this._virtualizationCacheCol.start===e&&this._virtualizationCacheCol.end===t||(this._virtualizationCacheCol={start:e,end:t,startWithExtra:l,endWithExtra:i}),o!==this._virtualizationCacheColDimension&&(this._virtualizationCacheColDimension=o);const a=this._dataColLength()>this.colBuffer?this.colBuffer/this._dataColLength():1,c=this._rootElement();c.style.setProperty("--extra-col-start-width",`${Math.max(r*a,0)}px`),c.style.setProperty("--extra-col-end-width",`${Math.max(n*a,0)}px`)}}return t.VIRTUALIZATION_MIN_COL_LEN=30,t.VIRTUALIZATION_MIN_ROW_LEN=30,t._virtalizationDefaults={start:0,end:0,startWithExtra:0,endWithExtra:null},W([(0,o.MZ)({type:Boolean,reflect:!0,attribute:"no-virtualization",converter:o.Bs}),j("design:type",Object)],t.prototype,"noVirtualization",void 0),W([(0,o.MZ)({type:Number,reflect:!1,attribute:"extra-virtualized"}),j("design:type",Object)],t.prototype,"extraVirtualized",void 0),W([(0,o.MZ)({type:Object,reflect:!1,attribute:!1}),j("design:type",Object)],t.prototype,"scrollbar",void 0),W([(0,o.MZ)({type:Number,reflect:!1,attribute:"row-buffer"}),j("design:type",Object)],t.prototype,"rowBuffer",void 0),W([(0,o.MZ)({type:Number,reflect:!1,attribute:"col-buffer"}),j("design:type",Object)],t.prototype,"colBuffer",void 0),W([(0,o.wk)(),j("design:type",Object)],t.prototype,"_virtualizationCacheRow",void 0),W([(0,o.wk)(),j("design:type",Object)],t.prototype,"_virtualizationCacheCol",void 0),W([(0,o.wk)(),j("design:type",Object)],t.prototype,"_virtualizationCacheRowDimension",void 0),W([(0,o.wk)(),j("design:type",Object)],t.prototype,"_virtualizationCacheColDimension",void 0),t};class V{constructor(e){this._scrollHierarchy=[],this._navigatorApiFailed=!1,this.handlePaste=this.handlePaste.bind(this),this.handleCopy=this.handleCopy.bind(this),this.handleCut=this.handleCut.bind(this),this.handleDelete=this.handleDelete.bind(this),this._ss=e}async handleDelete(e){const t=[];if(!this._ss.selectedCells.every((e=>{const s=e[0],o=e[1];if(this._ss._isDisabledCell(s,o))return!1;const l=this._remapChangedValue(s,o,"");return t.push({value:l,rowIndex:s,columnIndex:o}),!0})))return this._visualBellOnSelection("visual-bell-fail"),this._focusBackToRoot(),void e.stopPropagation();t.length>0&&(this._ss._dispatchChangeEvent(t),await this._ss.updateComplete,this._ss.selectedCells=t.map((e=>[e.rowIndex,e.columnIndex])),this._focusBackToRoot(),e.stopPropagation())}async handleCut(e){await this.handleCopy(e),await this.handleDelete(e)}async handlePaste(e){if(this._ss.editable){let t=!1;if(!this._navigatorApiFailed&&navigator.clipboard&&navigator.clipboard.readText?await navigator.clipboard.readText().then((async e=>{await this._decodeTabularData(e)})).catch((e=>{console.warn("Clipboard API failed paste. Fallback to workaround",e),this._navigatorApiFailed=!0,t=!0})):t=!0,t){this._storeScrollHierarchy(this._ss);const e=this._createTextBox("");setTimeout((async()=>{this._restoreScrollHierarchy();const t=e.value;document.body.removeChild(e),await this._decodeTabularData(t)}),0)}e.stopPropagation()}}async handleCopy(e){const t=this._doEncode();if(!t)return;let s=!1;if(!this._navigatorApiFailed&&navigator.clipboard&&navigator.clipboard.writeText?await navigator.clipboard.writeText(t).catch((e=>{s=!0,console.warn("Clipboard API failed copy. Fallback to workaround",e)})):s=!0,s){const e=this._createTextBox(t);e.select(),setTimeout((async()=>{document.body.removeChild(e),this._focusBackToRoot()}),0)}e.stopPropagation(),this._visualBellOnSelection()}_prepareChanges(e,t,s){const o=[];for(let l=0;l<e.length;l++)for(let i=0;i<e[l].length;i++){const r=t+l,n=s+i;if(this._ss._isDisabledCell(r,n))return;const a=this._remapChangedValue(r,n,e[l][i]);let c=this._ss.data[r][n];null!==c&&"object"===typeof c&&(c=c.value),c!==a&&o.push({rowIndex:r,columnIndex:n,value:a})}return o}_remapChangedValue(e,t,s){const o=this._ss._controlType(e,t);return e===v?s:"checkbox"===o.type?!s||"string"===typeof s&&"false"===s.toLowerCase()?"FALSE":"TRUE":"number"===o.type?""===s?s:Number(s):s}_doEncode(){let e;const t=this._ss.selectedCells&&this._ss.selectedCells.length>0,s=this._ss.selectedColumns&&this._ss.selectedColumns.length>0,o=this._ss.selectedRows&&this._ss.selectedRows.length>0;if(this._ss.selectedTable)e=this._encodeTableSelection();else if(!t||o||s)if(!s||o||t){if(!o||t||s)return o||s||t?void this._visualBellOnSelection("visual-bell-fail"):void 0;e=this._encodeRowSelection()}else e=this._encodeColumnSelection();else e=this._encodeCellSelection();return e}_encodeCellSelection(){const e=[...this._ss.selectedCells],t=R(e),s=k(e);let o="";return new M([y(t[0]),x(s[0])],[y(t[t.length-1]),x(s[s.length-1])]).forEach(((e,t)=>{let[s,l]=t;const i=this._ss.selectedCells.findIndex((t=>S(t,e)));o+=i>-1?(l>0?V._colSeparator:"")+this._parseData(e[0],e[1]):V._colSeparator}),(()=>{o+=V._rowSeparator})),o}_encodeTableSelection(){let e="";for(let t=v;t<this._ss._dataRowLength();++t){for(let s=0;s<this._ss._dataColLength();++s)e+=(s>0?V._colSeparator:"")+this._parseData(t,s);e+=V._rowSeparator}return e}_encodeColumnSelection(){const e=this._ss.selectedColumns.sort(((e,t)=>e-t)),t=e[0],s=e[e.length-1];let o=this._encodeColumnHeaders(t,s);return new M([0,t],[this._ss.data.length-1,s]).forEach(((e,t)=>{let[s,l]=t;const i=this._ss.selectedColumns.findIndex((t=>t===e[1]));o+=i>-1?(l>0?V._colSeparator:"")+this._parseData(e[0],e[1]):V._colSeparator}),(()=>{o+=V._rowSeparator})),o}_encodeColumnHeaders(e,t){let s="";for(let o=e;o<=t;++o){if(this._ss.selectedColumns.findIndex((e=>e===o))>-1){let t=this._ss.columnHeader[o].title;void 0!==t&&null!==t||(t=""),s+=(o!==e?V._colSeparator:"")+t}else s+=V._colSeparator}return s+=V._rowSeparator,s}_encodeRowSelection(){const e=this._ss.selectedRows.sort(((e,t)=>e-t)),t=e[0],s=e[e.length-1];let o="";for(let l=t;l<=s;++l){if(this._ss.selectedRows.findIndex((e=>e===l))>-1){for(let e=0;e<this._ss.columnHeader.length;++e)o+=(0!==e?V._colSeparator:"")+this._parseData(l,e);o+=V._rowSeparator}}return o}_parseData(e,t){var s;let o;return o=-1===e?this._ss.columnHeader[t].title:this._ss.data[e][t],void 0===o||null===o?o="":"object"===typeof o&&(o=null!==(s=o.value)&&void 0!==s?s:""),o}async _decodeTabularData(e){const t=this._ss.data.length,s=this._ss.columnHeader.length,{clippeds:o,fail:l,columns:i}=this._decodeToClip(e,s);let r;if($(this._ss._lastSelectedCell)?this._ss._lastSelectedRow!==b?r=[this._ss._lastSelectedRow,0]:this._ss._lastSelectedColumn!==b&&(r=[-1,this._ss._lastSelectedColumn]):r=this._ss._lastSelectedCell,!r||l)return this._visualBell(),void this._focusBackToRoot();const n=r[0],a=r[1];if(n+o.length>t||a+i>s||n===v)return this._visualBellOnSelection("visual-bell-fail"),void this._focusBackToRoot();const c=this._prepareChanges(o,n,a);if(void 0===c)return this._visualBellOnSelection("visual-bell-fail"),void this._focusBackToRoot();this._ss._dispatchChangeEvent(c),await this._ss.updateComplete,this._ss.selectedCells=c.map((e=>[e.rowIndex,e.columnIndex])),this._ss._lastSelectedCell=r,this._focusBackToRoot()}_decodeToClip(e,t){const s=e.replace(/(\r\n|\n|\r)$/,"").split(/\r\n|\r|\n/),o=[];let l=-1,i=!1;for(let r=0;r<s.length;r++)o[r]=s[r].split(String.fromCharCode(9)),o[r]=this._removeTrailingEmpties(o[r],t),l>-1&&l!==o[r].length?i=!0:l=o[r].length;return{clippeds:o,fail:i,columns:l}}_removeTrailingEmpties(e,t){for(;e.length>t&&!e[e.length-1];)e.pop();return e}_focusBackToRoot(){this._ss._root.focus({preventScroll:!0})}_visualBell(){this._ss._root.classList.add("visual-bell-fail"),setTimeout((()=>this._ss._root.classList.remove("visual-bell-fail")),250)}_visualBellOnSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"visual-bell-ok";this._ss.shadowRoot.querySelectorAll('[class*="--selected-cell"], [class*="--selected-column"], [class*="--selected-row"], [selected-column], [selected-cell], [selected-row]').forEach((t=>{t.style.setProperty("animation-name",e),setTimeout((()=>t.style.removeProperty("animation-name")),250)}))}_storeScrollHierarchy(e){this._scrollHierarchy=[];const t=e=>{const t=e.parentElement;if(!t){const t=e.getRootNode?e.getRootNode():void 0;return t&&t.host}return t};let s=t(e);for(;s;)this._scrollHierarchy.push([s,s.scrollLeft,s.scrollTop]),s=t(s)}_restoreScrollHierarchy(){this._scrollHierarchy.forEach((function(e){const t=e[0];t.scrollLeft!==e[1]&&(t.scrollLeft=e[1]),t.scrollTop!==e[2]&&(t.scrollTop=e[2])})),this._scrollHierarchy=[]}_createTextBox(e){const t=document.createElement("textarea");return t.setAttribute("maxlength","2000000"),t.style.position="absolute",t.style.left="-1000px",t.style.top="-1000px",t.value=e,document.body.appendChild(t),document.designMode="off",t.focus({preventScroll:!0}),t}}V._rowSeparator="\n",V._colSeparator="\t";class P{constructor(e){this._callbacks=[],this._keyDown=this._keyDown.bind(this),this._ss=e,this._ss.addEventListener("keydown",this._keyDown)}registerCallback(e,t){this._callbacks.push(Object.assign({cb:e},t))}async _keyDown(e){let t=!0;for(const s of this._callbacks)t&&("string"===typeof s.key&&s.key===e.key||s.key instanceof RegExp&&s.key.test(e.key))&&(!s.modifier||s.modifier({ctrl:e.ctrlKey,meta:e.metaKey,alt:e.altKey,shift:e.shiftKey}))&&(await s.cb(e),t=!1)}}P.modifierNoAltSNohift=e=>{let{alt:t,shift:s}=e;return!t&&!s},P.modifierCtrlOrMeta=e=>{let{ctrl:t,meta:s}=e;return t||s},P.modifierShift=e=>{let{shift:t}=e;return t},P.modifierAlt=e=>{let{alt:t}=e;return t};class Z{constructor(e,t){this.top=e[0],this.left=e[1],this.right=t[1],this.bottom=t[0]}get x(){return this.left}get y(){return this.top}get width(){return this.right-this.left}get height(){return this.bottom-this.top}set x(e){const t=this.left-e;this.left=e,this.right-=t}set y(e){const t=this.top-e;this.top=e,this.bottom-=t}set width(e){this.right=this.left+e}set height(e){this.bottom=this.top+e}isEmpty(){return this.left>=this.right||this.top>=this.bottom}setRect(e,t,s,o){return this.left=e,this.top=t,this.right=e+s,this.bottom=t+o,this}setBounds(e,t,s,o){return this.top=t,this.left=e,this.bottom=o,this.right=s,this}equals(e){return null!=e&&(this.isEmpty()&&e.isEmpty()||this.top===e.top&&this.left===e.left&&this.bottom===e.bottom&&this.right===e.right)}clone(){return new Z([this.top,this.left],[this.bottom,this.right])}translate(e,t){return this.left+=e,this.right+=e,this.top+=t,this.bottom+=t,this}union(e){return this.clone().expandToContain(e)}contains(e){return!!e.isEmpty()||!this.isEmpty()&&(e.left>=this.left&&e.right<=this.right&&e.top>=this.top&&e.bottom<=this.bottom)}intersect(e){return this.clone().restrictTo(e)}intersects(e){const t=Math.max(this.left,e.left),s=Math.min(this.right,e.right),o=Math.max(this.top,e.top),l=Math.min(this.bottom,e.bottom);return t<=s&&o<=l}restrictTo(e){if(this.isEmpty()||e.isEmpty())return this.setRect(0,0,0,0);const t=Math.max(this.left,e.left),s=Math.min(this.right,e.right),o=Math.max(this.top,e.top),l=Math.min(this.bottom,e.bottom);return this.setRect(t,o,Math.max(0,s-t),Math.max(0,l-o))}expandToContain(e){const t=Math.min(this.left,e.left),s=Math.max(this.right,e.right),o=Math.min(this.top,e.top),l=Math.max(this.bottom,e.bottom);return this.setBounds(t,o,s,l)}expandToIntegers(){return this.left=Math.floor(this.left),this.top=Math.floor(this.top),this.right=Math.ceil(this.right),this.bottom=Math.ceil(this.bottom),this}scale(e,t){return this.left*=e,this.right*=e,this.top*=t,this.bottom*=t,this}map(e){return this.left=e.call(this,this.left),this.top=e.call(this,this.top),this.right=e.call(this,this.right),this.bottom=e.call(this,this.bottom),this}translateInside(e){const t=e.left-this.left,s=this.right>e.right?e.right-this.right:0,o=this.bottom>e.bottom?e.bottom-this.bottom:0,l=e.top-this.top,i=this.left<=e.left?t:s,r=this.top<=e.top?l:o;return this.translate(i,r)}subtract(e){const t=new Z(w,w),s=[];return(e=e.intersect(this)).isEmpty()?[this.clone()]:(t.setBounds(this.left,this.top,e.left,this.bottom),t.isEmpty()||s.push(t.clone()),t.setBounds(e.left,this.top,e.right,e.top),t.isEmpty()||s.push(t.clone()),t.setBounds(e.left,e.bottom,e.right,this.bottom),t.isEmpty()||s.push(t.clone()),t.setBounds(e.right,this.top,this.right,this.bottom),t.isEmpty()||s.push(t.clone()),s)}blend(e,t){return new Z([this.top+(e.top-this.top)*t,this.left+(e.left-this.left)*t],[this.bottom+(e.bottom-this.bottom)*t,this.right+(e.right-this.right)*t])}inflate(e,t){const s=(this.width*e-this.width)/2,o=arguments.length>1?t:e,l=(this.height*(null!==o&&void 0!==o?o:1)-this.height)/2;return this.left-=s,this.right+=s,this.top-=l,this.bottom+=l,this}touches(e){return this.left===e.left&&this.right===e.right&&(this.top===e.bottom||this.bottom===e.top)||this.top===e.top&&this.bottom===e.bottom&&(this.left===e.right||this.right===e.left)}}class q{constructor(){this._ranges=[]}get ranges(){return this._ranges}clear(){this._ranges=[]}containExact(e,t){const s=new Z(e,t);return this._ranges.findIndex((e=>e.equals(s)))>-1}contains(e){const t=new Z(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e);return this._ranges.findIndex((e=>e.contains(t)))>-1}add(e,t){const s=R([...e]),o=k([...e]),l=[y(s[0]),x(o[0])],i=[y(s[s.length-1])+1,x(o[o.length-1])+1],r=new Z(l,i);if(t){if(this._ranges.some((e=>e.equals(r))))return;this._ranges.push(r)}else this._solveIntersects(r)}_solveIntersects(e){const t=[];this._ranges.forEach((s=>{s.intersects(e)&&t.push(s)})),t.forEach((t=>{const s=t.subtract(e);this._rangesRemove(t),this._ranges.push(...s)}))}_rangesRemove(e){const t=this._ranges.findIndex((t=>t.equals(e)));this._ranges.splice(t,1)}}class K{}K.getRow=(e,t)=>e.querySelector(`[class*="-row"][index="${t}"]`),K.getColumn=(e,t)=>e.querySelector(`[class$="-col-index"][index="${t}"]`),K.getCell=(e,t,s)=>e.querySelector(`[rIndex="${t}"][cIndex="${s}"]`),K.getColumnTile=(e,t)=>e.querySelector(`[class$="-col-title"][index="${t}"]`),K.getCellInputCheckBox=(e,t,s)=>e.querySelector(`[rIndex="${t}"][cIndex="${s}"] > input[type="checkbox"]`),K.getCellInputSelect=(e,t,s)=>e.querySelector(`[rIndex="${t}"][cIndex="${s}"] > select`),K.getCellInputTextfield=e=>e.querySelector('input[type="text"], input[type="number"]'),K.getCellSpan=e=>e.querySelector("span"),K.getStickyColumn=e=>e.querySelector('[class$="-h"]'),K.getStickyHeader=e=>e.querySelector('[class$="-head"]'),K.getScroller=e=>e.querySelector('[class$="-scroll"]');const U=K;class J{constructor(e){this.model=new q,this.tableSelected=()=>this.model.containExact([v,0],[this._lastRow()+1,this._lastCol()+1]),this.columnSelected=e=>this.model.containExact([v,e],[this._lastRow()+1,e+1]),this.rowSelected=e=>this.model.containExact([e,0],[e+1,this._lastCol()+1]),this.cellSelected=(e,t)=>this.model.contains([e,t],[e+1,t+1]),this._onKeyEsc=async e=>{var t,s,o;if(!$(this._ss._editingCell))return void this._ss.setEditing(w);this._ss._lastSelectedCell=w,this._ss._lastSelectedColumn=b,this._ss._lastSelectedRow=b;let l=!1;this._ss.selectedTable=!1,(null===(t=this._ss.selectedColumns)||void 0===t?void 0:t.length)>0&&(this._ss.selectedColumns=[],l=!0),(null===(s=this._ss.selectedRows)||void 0===s?void 0:s.length)>0&&(this._ss.selectedRows=[],l=!0),(null===(o=this._ss.selectedCells)||void 0===o?void 0:o.length)>0&&(this._ss.selectedCells=[],l=!0),this.model.clear(),l&&this._dispatchSelectEvent(),E(e)},this._onSelectAll=async e=>{this.model.clear(),this.model.add([C,this._lastCell()],!0),E(e),this._ss.selectedTable=!0,this._ss.selectedColumns=this._ss.selectedColumns.length>0?[]:this._ss.selectedColumns,this._ss.selectedRows=this._ss.selectedRows.length>0?[]:this._ss.selectedRows,this._ss.selectedCells=this._ss.selectedCells.length>0?[]:this._ss.selectedCells},this._onArrowLeftToMove=async e=>{await this._goHorizontal(e,m,this._lastCol())},this._onArrowRightToMove=async e=>{await this._goHorizontal(e,1,0)},this._onArrowUpToMove=async e=>{await this._goVertical(e,m)},this._onArrowDownToMove=async e=>{await this._goVertical(e,1)},this._onEnterToMoveDown=async e=>{await this._goVertical(e,1,!1)},this._onArrowUpToExpand=async e=>this._dragExpandByShiftArrowKeys(e,-1,0),this._onArrowDownToExpand=async e=>this._dragExpandByShiftArrowKeys(e,1,0),this._onArrowLeftToExpand=async e=>this._dragExpandByShiftArrowKeys(e,0,-1),this._onArrowRightToExpand=async e=>this._dragExpandByShiftArrowKeys(e,0,1),this._onKeyToSelectRowsFromCells=async e=>{const t=this._ss.selectedCells&&this._ss.selectedCells.length>0;if(t||!$(this._ss._lastSelectedCell)){const s=t?this._ss.selectedCells:[this._ss._lastSelectedCell],o=[];s.forEach((e=>{const t=e[0];this._ss.selectedRows&&this._ss.selectedRows.indexOf(t)<0&&o.push(t)})),o.forEach((e=>{this._removeSelectedCellsForRow(e)})),o.length>0&&(this._ss.selectedRows=[...this._ss.selectedRows,...o],this._dispatchSelectEvent()),E(e)}},this._onKeyToSelectColumnsFromCells=async e=>{const t=this._ss.selectedCells&&this._ss.selectedCells.length>0;if(t||!$(this._ss._lastSelectedCell)){const s=t?this._ss.selectedCells:[this._ss._lastSelectedCell],o=[];s.forEach((e=>{const t=e[1];this._ss.selectedColumns&&this._ss.selectedColumns.indexOf(t)<0&&o.push(t)})),o.forEach((e=>{this._removeSelectedCellsForColumn(e)})),o.length>0&&(this._ss.selectedColumns=[...this._ss.selectedColumns,...o],this._dispatchSelectEvent()),E(e)}},this._onKeyUpHandlerForShift=e=>{"Shift"===e.key?(this._mapDragCellsToSelectedCells(this._ss._dragSelected),this._ss._dragSelected=void 0):this._addListenerForShift(e)},this._addListenerForShift=e=>e.target.addEventListener("keyup",this._onKeyUpHandlerForShift,{once:!0}),this._selections=()=>({selectedCell:this._ss.selectedCells&&1===this._ss.selectedCells.length,selectedColumn:this._ss.selectedColumns&&1===this._ss.selectedColumns.length,selectedRow:this._ss.selectedRows&&1===this._ss.selectedRows.length}),this._lastCell=()=>[this._lastRow(),this._lastCol()],this._lastRow=()=>this._ss._dataRowLength()-1,this._lastCol=()=>this._ss._dataColLength()-1,this._onArrowLeftToMove=this._onArrowLeftToMove.bind(this),this._onArrowRightToMove=this._onArrowRightToMove.bind(this),this._onArrowUpToMove=this._onArrowUpToMove.bind(this),this._onArrowDownToMove=this._onArrowDownToMove.bind(this),this._onEnterToMoveDown=this._onEnterToMoveDown.bind(this),this._ss=e}setSelectedCell(e){this._ss.selectedCells=[e],this._dispatchSelectEvent()}columnSelect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{unselect:!1,byMouse:!1,forceSelect:!1};const{unselect:s,byMouse:o,forceSelect:l}=t;this.resetSelects("column",s);const i=this._ss.selectedColumns.indexOf(e);let r=!1;i>-1&&!l?(this._ss.selectedColumns.splice(i,1),this._ss.selectedColumns=[...this._ss.selectedColumns],this.model.add([[-1,e],[this._lastRow(),e]],!1),r=!0):i>-1&&l||(this._ss.singleSelect&&this._ss.selectedColumns.length>0?(this._ss.selectedColumns=[e],r=!0,this.model.clear()):(this._ss.selectedColumns=[...this._ss.selectedColumns,e],-1===this._ss._focusableColumn&&o&&(this._ss._root.focus(),this._ss._focusableColumn=e),this._ss._lastSelectedColumn=e,r=!0),this.model.add([[-1,e],[this._lastRow(),e]],!0),this._removeSelectedCellsForColumn(e)),r&&this._dispatchSelectEvent()}rowSelect(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{unselect:!1,byMouse:!1,forceSelect:!1};const{unselect:s,byMouse:o,forceSelect:l}=t;this.resetSelects("row",s);const i=this._ss.selectedRows.indexOf(e);let r=!1;i>-1&&!l?(this.model.add([[e,0],[e,this._lastCol()]],!1),this._ss.selectedRows.splice(i,1),this._ss.selectedRows=[...this._ss.selectedRows],r=!0):i>-1&&l||(this._ss.singleSelect&&this._ss.selectedRows.length>0?(this._ss.selectedRows=[e],r=!0,this.model.clear()):(this._ss.selectedRows=[...this._ss.selectedRows,e],-1===this._ss._focusableRow&&o&&(this._ss._root.focus(),this._ss._focusableRow=e),this._ss._lastSelectedRow=e,r=!0),this.model.add([[e,0],[e,this._lastCol()]],!0),this._removeSelectedCellsForRow(e)),r&&this._dispatchSelectEvent()}cellSelect(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{unselect:!1,byMouse:!1,forceSelect:!1};const{unselect:o,forceSelect:l}=s;if(this.resetSelects("cell",o),-1===this._ss.selectedColumns.indexOf(t)&&-1===this._ss.selectedRows.indexOf(e)){const s=this.selectedCellIndex([e,t]);let o=!1;s>-1&&!l?(this.model.add([this._ss.selectedCells[s]],!1),this._ss.selectedCells.splice(s,1),this._ss.selectedCells=[...this._ss.selectedCells],o=!0):s>-1&&l||(this._ss.singleSelect&&this._ss.selectedCells.length>0?(this._ss.selectedCells=[[e,t]],this.model.clear()):this._ss.selectedCells=[...this._ss.selectedCells,[e,t]],this._ss._lastSelectedCell=[e,t],this.model.add([[e,t]],!0),o=!0),o&&this._dispatchSelectEvent()}}dragSelectColumns(e,t,s){this.resetSelects("column",s);const o=[],l=this._ss.selectedColumns.findIndex((t=>e===t))<0;this._ss._lastSelectedColumn=e,l?t.forEach((e=>{this._ss.selectedColumns.findIndex((t=>e[1]===t))<0&&(o.push(e[1]),this._removeSelectedCellsForColumn(e[1]))})):t.forEach((e=>{this._ss.selectedColumns.findIndex((t=>e[1]===t))>-1&&o.push(e[1])})),o.length>0&&(this._ss.selectedColumns=l?[...this._ss.selectedColumns,...o]:[...this._ss.selectedColumns.filter((e=>o.findIndex((t=>t===e))<0))],this._dispatchSelectEvent())}dragSelectRows(e,t,s){this.resetSelects("row",s);const o=[],l=this._ss.selectedRows.findIndex((t=>e===t))<0;this._ss._lastSelectedRow=e,t.forEach((e=>{const t=e[0],s=[t>-1?this._ss._sortedData[t][0]:t,e[1]];(l?this._ss.selectedRows.findIndex((e=>s[0]===e))<0:this._ss.selectedRows.findIndex((e=>s[0]===e))>-1)&&(o.push(s[0]),l&&this._removeSelectedCellsForRow(s[0]))})),o.length>0&&(this._ss.selectedRows=l?[...this._ss.selectedRows,...o]:[...this._ss.selectedRows.filter((e=>o.findIndex((t=>t===e))<0))],this._dispatchSelectEvent())}dragSelectCells(e,t,s,o){this.resetSelects("cell",o);const l=this._ss.selectedCells.findIndex((s=>S([e,t],s)))<0;this._ss._lastSelectedCell=[e,t],this._mapDragCellsToSelectedCells(s,l)}resetSelects(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._ss._lastSelectedCell=w,this._ss._lastSelectedColumn=b,this._ss._lastSelectedRow=b,this._ss._editingCell[0]!==b&&this._ss.setEditing(w),this._ss.selectedTable=!1,!this._ss.singleSelect&&!t)return this._ss.selectedCells.splice(0,this._ss.selectedCells.length),this._ss.selectedRows.splice(0,this._ss.selectedRows.length),void this._ss.selectedColumns.splice(0,this._ss.selectedColumns.length);this._ss.multiTypeSelect||("cell"!==e&&this._ss.selectedCells&&this._ss.selectedCells.length>0&&this._ss.selectedCells.splice(0,this._ss.selectedCells.length),"column"!==e&&this._ss.selectedColumns&&this._ss.selectedColumns.length>0&&this._ss.selectedColumns.splice(0,this._ss.selectedColumns.length),"row"!==e&&this._ss.selectedRows&&this._ss.selectedRows.length>0&&this._ss.selectedRows.splice(0,this._ss.selectedRows.length))}selectedCellIndex(e){let t=-1;return this._ss.selectedCells.length>0&&(this._ss.selectedCells.some((s=>(t++,S(s,e))))||(t=-1)),t}findSelectedCellForColumn(e){let t=-1;return this._ss.selectedCells.some((s=>(t++,s[1]===e)))||(t=-1),t}findSelectedCellForRow(e){let t=-1;return this._ss.selectedCells.some((s=>(t++,s[0]===e)))||(t=-1),t}_dragExpandByShiftArrowKeys(e,t,s){this._ss.singleSelect||S(this._ss._lastSelectedCell,w)||(this._ss._dragSelected?this._shiftArrowPress(t,s):this._enterShiftArrowMode(t,s,e),E(e))}_shiftArrowPress(e,t){const s=this._ss._dragSelected.to(),o=this._ss._dragSelected.from(),l=this._ss._sortedData.findIndex((e=>e[0]===this._ss._lastSelectedCell[0])),i=S([l,this._ss._lastSelectedCell[1]],o)?s:o;if(this._ss._dragSelected=this._moveRect([l,this._ss._lastSelectedCell[1]],i,e,t),0!==t){const e=U.getColumn(this._ss._root,this._ss._dragSelected.to()[1]);this._ss._scrollColumnIfNeeded(e,"auto",16)}if(0!==e){const e=this._ss._dragSelected.to()[0]>-1?this._ss._sortedData[this._ss._dragSelected.to()[0]][0]:-1,t=U.getRow(this._ss._root,e);this._ss._scrollRowIfNeeded(t,"smooth",16)}}_enterShiftArrowMode(e,t,s){const o=this._ss._sortedData.findIndex((e=>e[0]===this._ss._lastSelectedCell[0]));this._ss._dragSelected=this._moveRect([o,this._ss._lastSelectedCell[1]],[o,this._ss._lastSelectedCell[1]],e,t),this._addListenerForShift(s)}_moveRect(e,t,s,o){const l=y(t),i=x(t),r=l+s,n=i+o;return new M(e,[r<v||r>this._ss._dataRowLength()-1?l:r,n<0||n>this._ss._dataColLength()-1?i:n])}_mapDragCellsToSelectedCells(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const s=t?this._mapDragInclusive(e):this._mapDragExclusive(e);s.length>0&&(t?(this.model.add(s,!0),this._ss.selectedCells=[...this._ss.selectedCells,...s]):(this.model.add(s,!1),this._ss.selectedCells=[...this._ss.selectedCells.filter((e=>s.findIndex((t=>S(t,e)))<0))]),this._dispatchSelectEvent())}_mapDragExclusive(e){const t=[];return e.forEach((e=>{this._ss.selectedCells.findIndex((t=>S(e,t)))>-1&&t.push(e)})),t}_mapDragInclusive(e){const t=[];return e.forEach((e=>{const s=e[0],o=[s>-1?this._ss._sortedData[s][0]:s,e[1]];this._ss.selectedCells.findIndex((e=>S(o,e)))<0&&!this._ss.selectedColumns.includes(o[1])&&!this._ss.selectedRows.includes(o[0])&&t.push(o)})),t}async _goHorizontal(e,t,s){const{selectedCell:o,selectedColumn:l}=this._selections();if(l&&!o){const o=this._ss.selectedColumns[0];await this._ss._navigateToColumn(o,t,s,(async e=>{this._ss.selectedColumns=[e.index],this._ss._lastSelectedCell=w,this._dispatchSelectEvent()})),E(e)}else if(!l&&o){const o=this._ss.selectedCells[0][1];await this._ss._navigateToColumn(o,t,s,(async e=>{this._ss.selectedCells=[[this._ss.selectedCells[0][0],e.index]],this._ss._lastSelectedCell=[this._ss.selectedCells[0][0],e.index],this._dispatchSelectEvent()})),E(e)}}async _goVertical(e,t){let s=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const{selectedCell:o,selectedRow:l}=this._selections();l&&!o?(await this._ss._navigateToRow(this._ss.selectedRows[0],t,(async e=>{this._ss.selectedRows=[parseInt(e.getAttribute("index"),10)],this._ss._lastSelectedCell=w,this._dispatchSelectEvent()}),s),E(e)):!l&&o&&(await this._ss._navigateToRow(this._ss.selectedCells[0][0],t,(async e=>{const t=parseInt(e.getAttribute("index"),10);this._ss.selectedCells=[[t,this._ss.selectedCells[0][1]]],this._ss._lastSelectedCell=[t,this._ss.selectedCells[0][1]],this._dispatchSelectEvent()}),s),E(e))}_removeSelectedCellsForColumn(e){let t=!0;for(;t;){const s=this.findSelectedCellForColumn(e);s>-1?this._ss.selectedCells.splice(s,1):t=!1}}_removeSelectedCellsForRow(e){let t=!0;for(;t;){const s=this.findSelectedCellForRow(e);s>-1?this._ss.selectedCells.splice(s,1):t=!1}}_dispatchSelectEvent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.Select;const t=this._ss.selectedRows,s=this._ss.selectedColumns,o=this._ss.selectedCells;this._ss.dispatch(e,{value:{row:t,column:s,cell:o}})}}var G=function(e,t,s,o){var l,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(r=(i<3?l(r):i>3?l(t,s,r):l(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},Y=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const X=e=>{class t extends e{constructor(){super(...arguments),this._observeNavigationType=e=>{let t,s=()=>{};const o=o=>{"Tab"===o.key&&"tab"!==t&&(t="tab",!1===e("tab")&&s())},l=()=>{"pointer"!==t&&(t="pointer",!1===e("pointer")&&s())};return s=()=>{window.removeEventListener("keydown",o),window.removeEventListener("mousedown",l),window.removeEventListener("touchstart",l),window.removeEventListener("pointerdown",l)},window.addEventListener("keydown",o,!1),window.addEventListener("mousedown",l,!1),window.addEventListener("touchstart",l,!1),window.addEventListener("pointerdown",l,!1),s}}connectedCallback(){super.connectedCallback(),this._unobserveNavigationType=this._observeNavigationType((e=>{this.navigationType=e}))}disconnectedCallback(){super.disconnectedCallback(),this._unobserveNavigationType&&this._unobserveNavigationType()}}return G([(0,o.wk)(),Y("design:type",String)],t.prototype,"navigationType",void 0),t};var Q=function(e,t,s,o){var l,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(r=(i<3?l(r):i>3?l(t,s,r):l(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},ee=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};const te=e=>{class t extends((0,F.K)(e)){constructor(){for(var e,t=arguments.length,s=new Array(t),l=0;l<t;l++)s[l]=arguments[l];super(s),e=this,this.editable=!1,this._editingCell=w,this._inputFieldClicked=!1,this.isEditing=()=>!$(this._editingCell),this.getEditing=()=>this._editingCell,this.setEditing=e=>this._editingCell=e,this.isEditingCell=(e,t)=>S(this.getEditing(),[e,t]),this.isInputFieldClicked=()=>this._inputFieldClicked,this.setInputFieldClicked=e=>this._inputFieldClicked=e,this.renderEditInput=(e,t,s,l,i,r,n,a)=>o.qy`<input
                class="${e}-edit"
                type="text"
                .value="${null!==l&&void 0!==l?l:""}"
                .oldValue="${l}"
                placeholder="${i}"
                @change=${e=>n(e,t,s)}
                @input=${e=>{r&&(e.target.value=e.target.value.replace(/[^0-9\-.,e+]/g,""))}}
                @keydown=${async e=>a(e,t,s)}
                data-testid="input"
            />`,this.renderEditCheckbox=(e,t,s,l,i,r)=>o.qy`<input
                class="${e}-checkbox"
                tabindex="-1"
                type="checkbox"
                ?checked=${(0,o.Bs)(l)}
                disabled=${(0,o.JR)(!!i||void 0)}
                @change=${e=>r(e,t,s,"checkbox")}
                data-testid="checkbox"
            />`,this.renderEditSelect=(e,t,s,l,i,r,n)=>{const a=i.map((e=>"string"===typeof e?o.qy` <option ?selected=${l===e}>${e}</option>`:o.qy` <option ?selected=${l===e.value} value="${e.value}">${e.label}</option>`));return o.qy`<select
                class="${e}-select"
                tabindex="-1"
                .value="${l}"
                disabled=${(0,o.JR)(!!r||void 0)}
                @change=${e=>n(e,t,s,"select")}
                data-testid="select"
            >
                ${a}
            </select>`},this.handleEditingCellFixed=(e,t,s)=>{!this.editable||s||S(this._editingCell,[e,t])||this._startEdit(e,t,!0)},this.handleEditingCell=function(t,s,o,l,i){let r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e._editingCell[0]!==b)e._editingCell=w;else if(e.editable&&!i&&!o&&S(l,[t,s]))return e._startEdit(t,s,r),!0;return!1},this._handleFocusOfInput=()=>{if(this.isEditing()){const e=U.getCellInputTextfield(this.shadowRoot);if(e&&!e.disabled)return void this._focusInput(e);const t=this.getEditing(),s=U.getCellInputCheckBox(this.shadowRoot,t[0],t[1]);if(s&&!s.disabled)return void s.focus()}this._editingCell[0]>-1&&this._root.focus({preventScroll:!0})},this._dispatchEditingStateEvent=e=>{this._editingCell!==w&&e===w?this.dispatch(c.EditBegin,{rowIndex:this._editingCell[0],columnIndex:this._editingCell[1]}):this._editingCell===w&&e!==w&&this.dispatch(c.EditEnd,{rowIndex:e[0],columnIndex:e[1]})},this._focusInput=e=>{if(e.focus(),this.isInputFieldClicked()){let t=!1;"number"===e.type&&(t=!0,e.type="text"),e.setSelectionRange(e.value.length,e.value.length),t&&(e.type="number")}else e.select()}}updated(e){super.updated(e);const t=e.get("_editingCell");void 0!==t&&(this._dispatchEditingStateEvent(t),this._handleFocusOfInput())}_startEdit(e,t,s){const o=U.getCellInputCheckBox(this.shadowRoot,e,t);if(o)o.focus();else{const o=U.getCellInputSelect(this.shadowRoot,e,t);if(o)o.focus();else if(this._inputFieldClicked=s,this._editingCell=[e,t],e===i){U.getColumnTile(this.shadowRoot,t).focus()}}}}return Q([(0,o.MZ)({type:Boolean,attribute:"editable",converter:o.Bs}),ee("design:type",Object)],t.prototype,"editable",void 0),Q([(0,o.wk)(),ee("design:type",Array)],t.prototype,"_editingCell",void 0),t};var se,oe=function(e,t,s,o){var l,i=arguments.length,r=i<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,s):o;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,s,o);else for(var n=e.length-1;n>=0;n--)(l=e[n])&&(r=(i<3?l(r):i>3?l(t,s,r):l(t,s))||r);return i>3&&r&&Object.defineProperty(t,s,r),r},le=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ie=se=class extends(te(N(X((0,L.z)(o.OC))))){constructor(){var e;super(),e=this,this.initialSort={column:b,order:a.Unset},this.columnSelect=!1,this.rowSelect=!1,this.cellSelect=!1,this.singleSelect=!1,this.multiTypeSelect=!1,this.bodyIndex=!1,this.compact=!1,this.hoverEffects=!1,this.overflowTooltip=!1,this.menu=!0,this.rowBuffer=5e5,this.colBuffer=6e4,this.columnMinWidth=100,this.data=[],this.columnHeader=[],this.rowExtra=[],this.decimals=6,this.headerFormat="num",this.selectedTable=!1,this.selectedRows=[],this.selectedColumns=[],this.selectedCells=[],this.editInPlace=!0,this._hoverCell={rowIndex:b,columnIndex:b},this._lastSelectedCell=w,this._lastSelectedColumn=b,this._lastSelectedRow=b,this._sortedData=[],this._currentRowHeight=se.NORMAL_ROW_HEIGHT,this._focusedColumn=b,this._focusableColumn=0,this._focusedRow=b,this._focusableRow=0,this._focusedCell=w,this._focusableCell=[0,0],this._keyboardManager=new P(this),this._clipboardManager=new V(this),this._selectionManager=new J(this),this._rootElement=()=>this._root,this._dataRowLength=()=>this._sortedData.length,this._dataColLength=()=>this.columnHeader&&this.columnHeader.length>0?this.columnHeader.length:this._sortedData&&this._sortedData.length>0?this._sortedData[0].length:0,this._rowHeight=()=>this._currentRowHeight,this._columnWidth=()=>"auto"===this.columnWidth?this._autoColumnWidth:this.columnWidth,this._createInternalData=()=>this.data.map(((e,t)=>{const s=[t,...e];return this._remapRow(s,e),s})),this._remapRow=(e,t)=>{e.index=t.index,e.textAlign=t.textAlign,e.backgroundColor=t.backgroundColor,e.color=t.color,e.bold=t.bold,e.italic=t.italic},this._getRenderedScrollbar=()=>this._getScroller()||U.getScroller(this.shadowRoot),this._setRowHeight=()=>{const e=this.style.getPropertyValue("--spreadsheet-row-height");this._currentRowHeight=e?parseInt(e.split("px")[0],10):this.compact?se.COMPACT_ROW_HEIGHT:se.NORMAL_ROW_HEIGHT},this._dispatchColumnHeader=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.dispatch("column-header",{newIndex:Array.from({length:t},((e,t)=>t+s))})},this._setColumnWidth=e=>this._root.style.setProperty("--spreadsheet-column-width",e),this._removeColumnWidth=()=>this._root.style.removeProperty("--spreadsheet-column-width"),this._valueGetter=e=>null!==e&&"object"===typeof e?e.value:e,this._getSortingFunction=e=>{var t;return(null===(t=this.columnHeader[e])||void 0===t?void 0:t.sortFunc)?this.columnHeader[e].sortFunc:T},this._renderHtmlForRowVirtual=e=>{let t=o.qy``,s=o.qy``;return this._isVrtualizerEnabled()&&(t=o.qy` <div class="${e}-start-row"></div> `,s=o.qy`
                <div class="${e}-end-row">
                    <div class="${e}-padding-cell"></div>
                </div>
            `),{virtualStartHtml:t,virtualEndHtml:s}},this._renderHtmlForColVirtual=e=>({virtualStartHtml:o.qy` <div class="${e}-start-col"></div> `,virtualEndHtml:o.qy` <div class="${e}-end-col"></div> `}),this._doColumnKeyboardNavigation=async e=>{const t=()=>{e.shiftKey&&this._selectionManager.columnSelect(this._focusedColumn,{unselect:!0,byMouse:!1,forceSelect:!0})},s=async e=>{this._focusedColumn=e.index,await this.updateComplete,e.focus()};if("ArrowRight"===e.key)E(e),t(),await this._navigateToColumn(this._focusedColumn,1,0,s);else if("ArrowLeft"===e.key){E(e),t();const o=this._dataColLength()-1;await this._navigateToColumn(this._focusedColumn,m,o<0?0:o,s)}else" "===e.key&&(E(e),this._selectionManager.columnSelect(this._focusedColumn,{unselect:e.ctrlKey||e.metaKey}))},this._doRowKeyboardNavigation=async e=>{const t=()=>{e.shiftKey&&this._selectionManager.rowSelect(this._focusedRow,{unselect:!0,byMouse:!1,forceSelect:!0})},s=async e=>{this._focusedRow=parseInt(e.getAttribute("index"),10),await this.updateComplete,e.focus()};"ArrowDown"===e.key?(E(e),t(),await this._navigateToRow(this._focusedRow,1,s)):"ArrowUp"===e.key?(E(e),t(),await this._navigateToRow(this._focusedRow,m,s)):" "===e.key&&(E(e),this._selectionManager.rowSelect(this._focusedRow,{unselect:e.ctrlKey||e.metaKey}))},this._doCellKeyboardNavigation=async e=>{const t=()=>{e.shiftKey&&this._selectionManager.cellSelect(this._focusedCell[0],this._focusedCell[1],{unselect:!0,byMouse:!1,forceSelect:!0})},s=this._focusedCell[0],o=this._focusedCell[1],l=async e=>this._focusCell(s,e.index),i=async e=>this._focusCell(parseInt(e.getAttribute("index"),10),o);if("ArrowRight"===e.key)E(e),t(),await this._navigateToColumn(o,1,0,l);else if("ArrowLeft"===e.key){E(e),t();const s=this._dataColLength()-1;await this._navigateToColumn(o,m,s<0?0:s,l)}else if("ArrowDown"===e.key)E(e),t(),await this._navigateToRow(s,1,i);else if("ArrowUp"===e.key)E(e),t(),await this._navigateToRow(s,m,i);else if(" "===e.key){if(E(e),this.handleEditingCell(this._focusedCell[0],this._focusedCell[1],e.ctrlKey||e.metaKey,this._lastSelectedCell,this._isDisabledCell(s,o)))return;this._selectionManager.cellSelect(this._focusedCell[0],this._focusedCell[1],{unselect:e.ctrlKey||e.metaKey})}},this._focusCell=async(e,t)=>{const s=U.getCell(this._body,e,t);this._focusedCell=[e,t],await this.updateComplete,s.focus()},this._navigateToColumn=async(e,t,s,o)=>{const l=this._root;let i=U.getColumn(l,e+t);i||(await this.scrollToColumn(s,"auto"),i=await A(l,`[class$="-col-index"][index="${s}"]`)),requestAnimationFrame((async()=>{this._scrollColumnIfNeeded(i,"auto"),o&&o(i)}))},this._navigateToRow=async function(t,s,o){let l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const i=e._findNewRowIndex(t,s,l),r=e._body;if(-1===i){const t=e._root.querySelector('[class$="-head"]').querySelectorAll('div[class$="-row"]')[1];o(t)}else{let t=U.getRow(r,i);t||(await e.scrollToRow(i,"auto"),t=await A(r,`[class*="-row"][index="${i}"]`)),requestAnimationFrame((async()=>{e._scrollRowIfNeeded(t,"auto"),o(t)}))}},this._colsData=e=>{const t=this._getColSpan();return t.start>-1?e.slice(t.start,t.end):e},this._rowsData=()=>{const e=this._getRowSpan();return e.start>-1?this._sortedData.slice(e.start,e.end):this._sortedData},this._colsRender=(e,t,s,l,r,n)=>{var c;const d=this._colsKey(s),{selectedColumn:h,firstSelectedColumn:u,lastSelectedColumn:_}=this._getColumnSelection(d),{selectedCell:p,selectedCellAfter:f,selectedCellBefore:m,selectedCellInColumn:v,selectedCellBelow:C}=this._getCellSelection(d,n),y=this._renderColumnHeadExtra(d);return o.qy`
            <${g.tag}
                class='${e}-col-title'
                label='${t.title}'
                .subLabel=${t.subTitle}
                icon=${t.icon}
                index=${d}
                ?disabled=${this._isDisabledCell(-2,d)}
                ?secondary=${this.compact}
                ?editable=${!this.bodyIndex&&!this.compact&&this.editable&&p}
                .sortable=${t.sortable}
                .sortOrder=${(0,o.JR)(null!==(c=t.sortOrder)&&void 0!==c?c:d!==this._sortingState.column?a.Unset:this._sortingState.order)}
                last=${d===this.columnHeader.length-1}
                ?selectable=${this.columnSelect}
                ?hover-column=${this._hoverColumnEffect(d)}
                ?selected-cell=${p}
                ?selected-cell-first=${p&&!m&&!this.selectedColumns.includes(d-1)}
                ?selected-cell-last=${p&&!f&&!this.selectedColumns.includes(d+1)}
                ?selected-cell-on-column=${v}
                ?drag-select=${this._dragSelected&&(this._dragSelected.contains([i,d])||this._dragSelected.contains([b,d]))}
                ?selected-column=${this.selectedTable||h}
                ?first-selected-column=${u&&!m}
                ?last-selected-column=${_&&!f}
                ?selected-row=${l}
                ?selected-row-below=${r||C}
                role='columnheader'
                @dblclick=${e=>e.target.focus()}
                @mousedown=${e=>this.columnSelect?this._onCellMouseDown(e,i,d):null}
                @mouseenter=${e=>this._onCellMouseEnter(e,i,d)}
                @mouseleave=${e=>this._onHeaderCellMouseLeave(e.target)}
                @keydown=${e=>this._editCellKeydownHandler(e,i,d)}
                @title-change=${e=>{this._onInputChange(e,i,d)}}
                @title-focus=${e=>{this.setEditing([i,d]),this.setInputFieldClicked(!0),e.stopPropagation()}}
                @title-blur=${e=>{var t;this.setEditing(w),null===(t=this._root)||void 0===t||t.focus({preventScroll:!0}),e.stopPropagation()}}
                data-testid='col-${d}'
                style=${B(Object.assign(Object.assign({},this._getHeadColorLine(t.colorLine)),{"--spreadsheet-head-title-weight":this._getHeadTitleFontWeightFor(t),"--spreadsheet-cell-background-color":this._getHeadCellBackgroundColorFor(t,d)}))}
            >
                ${y}
            </${g.tag}>`},this._colsRenderIndexRow=(e,t,s)=>{const l=this._colsKey(s),{selectedColumn:i,firstSelectedColumn:r,lastSelectedColumn:n}=this._getColumnSelection(l),a=l===this.columnHeader.length-1;return o.qy`
            <${g.tag}
                class='${e}-col-index'
                drag-select=${(0,o.JR)(!(!this._dragSelected||!this._dragSelected.contains([b,l]))||void 0)}
                tabindex=${(0,o.JR)(this._getTabindexForColumn(l))}
                label='${t.index||l}'
                index=${l}
                last=${a}
                show-index
                ?disabled=${this._isDisabledCell(-2,l)}
                ?hover-column=${(0,o.JR)(!!this._hoverColumnEffect(l)||void 0)}
                ?selectable=${this.columnSelect}
                ?selected-column=${this.selectedTable||i}
                ?first-selected-column=${this.selectedTable&&0===l||r}
                ?last-selected-column=${this.selectedTable&&a||n}
                ?selected-cell-on-column=${(0,o.JR)(this._selectionManager.findSelectedCellForColumn(l)>-1||void 0)}
                @focus=${e=>this._onColumnFocus(e)}
                @blur=${e=>this._onColumnBlur(e)}

                @mousedown=${e=>this.columnSelect?this._onCellMouseDown(e,b,l):null}
                @mouseenter=${e=>this._onCellMouseEnter(e,b,l)}
                @mouseleave=${e=>this._onColumnMouseLeave(e.target)}
            >
                ${t.index||l+1}
            </${g.tag}>`},this._onColumnFocus=e=>{this._focusedColumn=e.target.index},this._onColumnBlur=e=>{this._focusedColumn===e.target.index&&(this._focusedColumn=b)},this._onRowFocus=e=>{const t=e.target.getAttribute("index");this._focusedRow=t?parseInt(t,10):0},this._onRowBlur=e=>{const t=e.target.getAttribute("index");this._focusedRow===parseInt(t,10)&&(this._focusedRow=b)},this._onCellFocus=e=>{this._focusedCell=e},this._onCellBlur=e=>{S(this._focusedCell,e)&&!this.isEditing()&&(this._focusedCell=w)},this._onColumnMouseLeave=e=>this._onHeaderCellMouseLeave(e),this._getTabindexForColumn=e=>"tab"===this.navigationType&&this.columnSelect&&(this._focusedColumn<0&&this._focusableColumn===e||this._focusedColumn===e)?"0":void 0,this._getTabindexForRow=e=>"tab"===this.navigationType&&this.rowSelect&&(this._focusedRow<0&&this._focusableRow===e||this._focusedRow===e)?"0":void 0,this._getTabindexForCell=(e,t)=>"tab"===this.navigationType&&this.cellSelect&&($(this._focusedCell)&&S(this._focusableCell,[e,t])||S(this._focusedCell,[e,t]))?"0":void 0,this._rowsRender=(e,t,s)=>{var l,i,r,n,a;const c=this._rowsKey(t);let d="";const h=this._sortedData.length===c+1;h?d=` ${s}-row-last`:0===c&&(d=` ${s}-row-first`);const u=e[0],_=null!==(i=null===(l=this._sortedData[c-1])||void 0===l?void 0:l[0])&&void 0!==i?i:-1,p=null===(r=this._sortedData[c+1])||void 0===r?void 0:r[0],{selectedRow:g,firstSelectedRow:f,lastSelectedRow:m}=this._getRowSelection(u,c),{selectedRow:b}=this._getRowSelection(_,c-1),{selectedRow:v}=this._getRowSelection(p,c+1),w=this.rowExtra?this.rowExtra.find((e=>e.rowIndex===u)):null,C=null!==(n=e.textAlign)&&void 0!==n?n:this._getBodyRowAlignFor(w);return o.qy`
            <div
                class="${s}-row ${s}-bodyrow${d}"
                index="${u}"
                tabindex=${(0,o.JR)(this._getTabindexForRow(u))}
                @focus=${e=>this._onRowFocus(e)}
                @blur=${e=>this._onRowBlur(e)}
                style=${B({"--spreadsheet-row-background-color":null!==(a=e.backgroundColor)&&void 0!==a?a:this._getBodyRowBackgroundColorFor(w,c),"--spreadsheet-row-font-color":e.color,"--spreadsheet-row-font-weight":e.bold?"600":void 0,"--spreadsheet-row-font-style":e.italic?"italic":void 0})}
                data-testid="row-${u}"
                role="row"
            >
                ${this._renderCell(s,e,h,C,{realRowIndex:u,rowIndex:c,rowIndexBefore:_,rowIndexAfter:p},{selectedRow:g,firstSelectedRow:f,lastSelectedRow:m,selectedRowAbove:b,selectedRowBelow:v})}
            </div>
        `},this._hoverColumnEffect=e=>this._hoverCell.columnIndex===e&&(this.hoverEffects||this.compact),this._controlType=(e,t)=>{var s,o;let l;return this.control&&(l=this.control(e,t),l&&l.type)?l:(l=null===(o=null===(s=this.columnHeader)||void 0===s?void 0:s[t])||void 0===o?void 0:o.control,l&&l.type?l:{type:"text"})},this._onKeyEditing=async e=>{if(!$(this._lastSelectedCell)){if(this.handleEditingCell(this._lastSelectedCell[0],this._lastSelectedCell[1],!1,this._lastSelectedCell,this._isDisabledCell(this._lastSelectedCell[0],this._lastSelectedCell[1]),"Enter"===e.key))return;" "===e.key&&e.preventDefault()}},this._editCellKeydownHandler=async(e,t,s)=>{const o=()=>{this.setEditing(w),this._root.focus({preventScroll:!0})};if("Enter"===e.key){const t=U.getCellInputTextfield(this.shadowRoot);t&&!t.handled&&t.dispatchEvent(new Event("change")),await this._selectionManager._onEnterToMoveDown(e),o()}else"Escape"===e.key?(e.target.value=e.target.oldValue,this.setEditing(w),$(this._focusedCell)?this._root.focus({preventScroll:!0}):await this._focusCell(t,s),e.preventDefault()):this.isInputFieldClicked()||("ArrowDown"===e.key?(await this._selectionManager._onArrowDownToMove(e),o()):"ArrowUp"===e.key?(await this._selectionManager._onArrowUpToMove(e),o()):"ArrowRight"===e.key?(await this._selectionManager._onArrowRightToMove(e),o()):"ArrowLeft"===e.key&&(await this._selectionManager._onArrowLeftToMove(e),o()));e.stopPropagation()},this._getVisualRowIndex=e=>e+(this.bodyIndex?0:1)+(!this.compact&&this.columnHeader&&this.columnHeader.length>0?1:0),this._onCellMouseDown=(e,t,s)=>{if(-1===t&&(this.compact||this.bodyIndex))return;const o=[t,s];let l;l=t===b?"column":s===b?"row":"cell",this._drag={drag:!1,cell:e.target,include:e.ctrlKey||e.metaKey,shift:e.shiftKey,from:o,to:o,type:l},this.cellSelect&&window.addEventListener("mousemove",(e=>this._handleMouseMove(e,t,s)),{once:!0}),window.addEventListener("mouseup",(e=>this._handleMouseUp(e,t,s)),{once:!0})},this._onCellMouseEnter=async(e,t,s)=>{if(!this.isEditing())if(this._drag&&this.cellSelect&&!this.singleSelect){if(this._drag.drag=!0,"scroll"===this._drag.state)await new Promise((e=>setTimeout(e,200)));else if("long"===this._drag.state&&-1!==t)return;const e=this._getCellWhenMouseEnter(t,s,this._drag);if(null!==e&&(await this._scrollOnMouseEnter(e),this._drag)){this._drag.to=e;const t=this._sortedData.findIndex((t=>t[0]===e[0])),s=this._sortedData.findIndex((e=>e[0]===this._drag.from[0])),o=new M([s,this._drag.from[1]],[t,this._drag.to[1]]);this._dragSelected=o}}else this._onHeaderCellMouseEnter(t,s,e.target),this._updateSpanTitle(e)},this._onCellDblClick=(e,t)=>{this.handleEditingCellFixed(e,t,this._isDisabledCell(e,t))},this._onHeaderCellMouseEnter=(e,t,s)=>{this._hoverCell={rowIndex:e,columnIndex:t},this.dispatchEvent(new CustomEvent(c.CellMouseEnter,{detail:{rowIndex:e,columnIndex:t,target:s}}))},this._onHeaderCellMouseLeave=e=>{this.dispatchEvent(new CustomEvent(c.CellMouseLeave,{detail:{rowIndex:this._hoverCell.rowIndex,columnIndex:this._hoverCell.columnIndex,target:e}})),this._hoverCell={rowIndex:b,columnIndex:b}},this._getBodyCellTextAlignFor=e=>{var t,s,o;return null!==(o=null===(s=null===(t=this.columnHeader)||void 0===t?void 0:t[e])||void 0===s?void 0:s.bodyCellTextAlign)&&void 0!==o?o:""},this._getBodyCellBackgroundColorFor=(e,t,s)=>{var o,l;const i=this.colorCell?this.colorCell(e,t,s):"";if(i)return i;const r=null===(l=null===(o=this.columnHeader)||void 0===o?void 0:o[t])||void 0===l?void 0:l.bodyCellBackgroundColor;return r||(this.colorColumn?this.colorColumn(t):"")},this._getHeadCellBackgroundColorFor=(e,t)=>{var s;const o=null===e||void 0===e?void 0:e.headCellBackgroundColor;return o||(this.colorColumn?this.colorColumn(t):this.colorCell?this.colorCell(b,t,null!==(s=e.title)&&void 0!==s?s:""):"")},this._getHeadColorLine=e=>e?{"--color-line":`3px solid ${e}`,"--color-pad":"2px"}:{},this._getBodyRowBackgroundColorFor=(e,t)=>{let s=e?e.bodyCellBackgroundColor:"";return!s&&this.colorRow&&(s=this.colorRow(t)),s},this._getBodyRowAlignFor=e=>{var t;return e&&null!==(t=e.bodyCellTextAlign)&&void 0!==t?t:""},this._getHeadTitleFontWeightFor=e=>(null===e||void 0===e?void 0:e.headTitleBoldFont)?"600":"",this._onInputChange=function(t,s,o){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";var r;let n,a;if(t.stopPropagation(),t.target.handled=!0,n="checkbox"===l?t.target.checked:"select"===l?t.target.options[t.target.selectedIndex].value:null!==(r=t.target.value)&&void 0!==r?r:t.detail.value,s===i)a=e.columnHeader[o].title;else{a=null!==e.data[s][o]&&"object"===typeof e.data[s][o]?e.data[s][o].value:e.data[s][o]}a!==n&&(t.preventDefault(),t.stopPropagation(),e._dispatchChangeEvent([{value:n,rowIndex:s,columnIndex:o}])),e._root.focus({preventScroll:!0})},this._getSelectedCells=(e,t,s,o,l,i)=>{const r=this._selectionManager.selectedCellIndex([e,t])>-1;let n=!1,a=!1,c=!1,d=!1;return(r||o||s)&&(c=this._selectionManager.selectedCellIndex([l,t])>-1,d=this._selectionManager.selectedCellIndex([i,t])>-1,n=this._selectionManager.selectedCellIndex([e,t-1])>-1,a=this._selectionManager.selectedCellIndex([e,t+1])>-1),{selectedCellIndex:r,selectedCellIndexBefore:n,selectedCellIndexAfter:a,selectedCellIndexAbove:c,selectedCellIndexBelow:d}},this._formatCellValue=(e,t)=>{var s,o;return((null===(o=null===(s=this.columnHeader)||void 0===s?void 0:s[t])||void 0===o?void 0:o.formatter)||(0,z.wC)(6))(e)},this._getStickyColumnWidth=()=>U.getStickyColumn(this.shadowRoot).offsetWidth,this._getStickyHeaderHeight=()=>U.getStickyHeader(this.shadowRoot).offsetHeight,this._onArrowDownToScroll=async e=>{var t;return this._scrollHelper(e,{top:null!==(t=this._rowHeight())&&void 0!==t?t:100})},this._onArrowUpToScroll=async e=>{var t;return this._scrollHelper(e,{top:-(null!==(t=this._rowHeight())&&void 0!==t?t:100)})},this._onArrowLeftToScroll=async e=>{var t;return this._scrollHelper(e,{left:-(null!==(t=this._columnWidth())&&void 0!==t?t:100)})},this._onArrowRightToScroll=async e=>{var t;return this._scrollHelper(e,{left:null!==(t=this._columnWidth())&&void 0!==t?t:100})},this._sortingState=this.initialSort,this._onArrowDownToScroll=this._onArrowDownToScroll.bind(this),this._onArrowUpToScroll=this._onArrowUpToScroll.bind(this),this._onArrowRightToScroll=this._onArrowRightToScroll.bind(this),this._onArrowLeftToScroll=this._onArrowLeftToScroll.bind(this),this._dispatchChangeEvent=this._dispatchChangeEvent.bind(this),this._keyboardManager.registerCallback(this._clipboardManager.handlePaste,{key:/^[vV]$/,modifier:P.modifierCtrlOrMeta}),this._keyboardManager.registerCallback(this._clipboardManager.handleCopy,{key:/^[cC]$/,modifier:P.modifierCtrlOrMeta}),this._keyboardManager.registerCallback(this._clipboardManager.handleCut,{key:/^[xX]$/,modifier:P.modifierCtrlOrMeta}),this._keyboardManager.registerCallback(this._clipboardManager.handleDelete,{key:/^Delete$/}),this._keyboardManager.registerCallback(this._selectionManager._onSelectAll,{key:/^[aA]$/,modifier:P.modifierCtrlOrMeta}),this._keyboardManager.registerCallback(this._selectionManager._onArrowLeftToMove,{key:/^ArrowLeft$/,modifier:P.modifierNoAltSNohift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowRightToMove,{key:/^ArrowRight$/,modifier:P.modifierNoAltSNohift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowUpToMove,{key:/^ArrowUp$/,modifier:P.modifierNoAltSNohift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowDownToMove,{key:/^ArrowDown$/,modifier:P.modifierNoAltSNohift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowLeftToExpand,{key:/^ArrowLeft$/,modifier:P.modifierShift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowRightToExpand,{key:/^ArrowRight$/,modifier:P.modifierShift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowUpToExpand,{key:/^ArrowUp$/,modifier:P.modifierShift}),this._keyboardManager.registerCallback(this._selectionManager._onArrowDownToExpand,{key:/^ArrowDown$/,modifier:P.modifierShift}),this._keyboardManager.registerCallback(this._onArrowLeftToScroll,{key:/^ArrowLeft$/,modifier:P.modifierAlt}),this._keyboardManager.registerCallback(this._onArrowRightToScroll,{key:/^ArrowRight$/,modifier:P.modifierAlt}),this._keyboardManager.registerCallback(this._onArrowUpToScroll,{key:/^ArrowUp$/,modifier:P.modifierAlt}),this._keyboardManager.registerCallback(this._onArrowDownToScroll,{key:/^ArrowDown$/,modifier:P.modifierAlt}),this._keyboardManager.registerCallback(this._selectionManager._onKeyEsc,{key:/^Escape$/}),this._keyboardManager.registerCallback(this._selectionManager._onKeyToSelectRowsFromCells,{key:/^\s$/,modifier:P.modifierShift}),this._keyboardManager.registerCallback(this._selectionManager._onKeyToSelectColumnsFromCells,{key:/^\s$/,modifier:P.modifierCtrlOrMeta}),this._keyboardManager.registerCallback(this._onKeyEditing,{key:/^[\S ]$/}),this._keyboardManager.registerCallback(this._onKeyEditing,{key:/^Enter$/})}connectedCallback(){this.style.setProperty("display","none"),se.subRegister(g);const e=[];e.push({module:()=>s.e(9693).then(s.bind(s,59693)),elem:["Icon"]}),e.push({module:()=>s.e(5432).then(s.bind(s,93051)),elem:["Scrollbar"]}),se.dynSubRegister(e,(()=>{super.connectedCallback(),this.style.removeProperty("display")}))}_columnsAppear(e,t){this.compact||(this._columnAppearDebouncedCallback||(this._columnAppearDebouncedCallback=(0,D.Tz)(((e,t)=>this._dispatchColumnHeader(e,t)),250)),this._columnAppearDebouncedCallback(e,t))}_scrollOccured(e){this._scrollDebouncedCallback||(this._scrollDebouncedCallback=(0,D.Tz)((e=>this._findFirstVisibleSelectableElements(e)),250)),this._scrollDebouncedCallback(e)}_resizeOccured(e){this._recalculateAutoColumnWidth(e),"auto"===this.columnWidth&&this._root.style.setProperty("--spreadsheet-column-width",`${this._autoColumnWidth}px`)}scrollToCell(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"smooth";const o=this._getRenderedScrollbar(),l=e>b?Math.min(e*this._rowHeight(),o.scrollHeight-o.clientHeight):void 0,i=this._columnWidth();let r;if(t>b&&t<this._dataColLength()){const e=i?t*this._columnWidth():this.shadowRoot.querySelector(`div[cIndex="${t}"]`).offsetLeft-this._getStickyColumnWidth();r=Math.min(e,o.scrollWidth-o.clientWidth)}return function(e,t,s,o){return e?((e,t,s)=>void 0===s&&void 0===t||void 0===t&&void 0!==s&&e.scrollWidth<=e.clientWidth||void 0===s&&void 0!==t&&e.scrollHeight<=e.clientHeight)(e,t,s)?Promise.resolve():(e.scrollTo({top:t,left:s,behavior:o}),new Promise(((o,l)=>{const i=setTimeout((()=>{l()}),2e3),r=()=>{H(e,t,s)&&(e.removeEventListener("scroll",r),clearTimeout(i),o())};H(e,t,s)?(clearTimeout(i),o()):e.addEventListener("scroll",r)}))):Promise.reject()}(o,l,r,s)}scrollToColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";return this.scrollToCell(b,e,t)}scrollToRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth";return this.scrollToCell(e,b,t)}firstUpdated(e){super.firstUpdated(e),this.initialSort&&this._updateInitialSort(),this._updateColumnWidth(),this._updateColumnMinWidth(),this._updateColumnMaxWidth(),this.columnHeader&&!this.compact&&this.columnHeader.length<=se.VIRTUALIZATION_MIN_COL_LEN&&this._dispatchColumnHeader(this.columnHeader.length),this._setRowHeight()}willUpdate(e){super.willUpdate(e),e.has("data")&&(this._sortedData=this._createInternalData(),this._sortingState.order!==a.Unset&&this._updateSortingState(),this._installScrollResizeObserver()),e.has("_sortingState")&&(this._sortingState.order===a.Unset?this._sortedData=this._createInternalData():this._updateSortingState()),e.has("columnWidth")&&this._updateColumnWidth(),e.has("columnMinWidth")&&this._updateColumnMinWidth(),e.has("columnMaxWidth")&&this._updateColumnMaxWidth(),(e.has("columnHeader")||e.has("headerFormat"))&&this._updateColumnHeader(),e.has("compact")&&this._setRowHeight()}updated(e){super.updated(e),e.has("initialSort")&&this._updateInitialSort(),e.has("selectedCells")&&this.selectedCells&&(this._lastSelectedCell=this._updateLastSelected(this.selectedCells,this._lastSelectedCell,w,S)),e.has("selectedColumns")&&this.selectedColumns&&(this._lastSelectedColumn=this._updateLastSelected(this.selectedColumns,this._lastSelectedColumn,b,((e,t)=>e===t))),e.has("selectedRows")&&this.selectedRows&&(this._lastSelectedRow=this._updateLastSelected(this.selectedRows,this._lastSelectedRow,b,((e,t)=>e===t)))}render(){const[e,t]=(0,o.Yh)(this.tagName.toLowerCase(),{"column-select":this.columnSelect,"row-select":this.rowSelect,"cell-select":this.cellSelect,"hover-effects":this.hoverEffects||this.compact,compact:this.compact,editing:this.isEditing()}),s=this._renderHeader(e),{virtualStartHtml:i,virtualEndHtml:r}=this._renderHtmlForRowVirtual(e),n=o.qy`
            <div class="${e}-table" @keydown=${async e=>this._onTableKeyDown(e)}>
                <slot name="${l.TOOLBAR_SLOT}"></slot>
                <div class="${e}-head" data-testid="spreadsheet-head">${s}</div>
                <div
                    class="${e}-body"
                    data-testid="spreadsheet-body"
                    style="--padding-cell-content:${this.data.length};"
                >
                    ${i} ${this._renderRows(e)} ${r}
                </div>
            </div>
        `,a=this._getScroller()?n:o.qy`
                <${se.Scrollbar.tag} class="${e}-scroll">
                    ${n}
                </${se.Scrollbar.tag}>
            `;return o.qy` <div class="${t}" tabindex="-1">${a}</div> `}_updateLastSelected(e,t,s,o){return e.findIndex((e=>o(e,t)))>=0?t:1===e.length?e[0]:s}_recalculateAutoColumnWidth(e){const t=this._dataColLength();this._autoColumnWidth=(e-this._getStickyColumnWidth()-(t+1))/t}_findFirstVisibleSelectableElements(e){const t=this._getStickyColumnWidth(),s=this._getStickyHeaderHeight(),o=(e,s)=>{const o=s.offsetLeft-e.scrollLeft,l=s.offsetLeft+s.clientWidth-e.scrollLeft;return o>t&&l<e.clientWidth},l=(e,t)=>{const o=t.offsetTop-e.scrollTop,l=t.offsetTop+t.clientHeight-e.scrollTop;return o>s&&l<e.clientHeight},i=[...this._renderedCols],r=i.filter((e=>this.selectedColumns.find((t=>t===e.index)))).find((t=>o(e,t)));if(r)this._focusableColumn=r.index;else{const t=i.find((t=>o(e,t)));this._focusableColumn=t?t.index:0}const n=e=>parseInt(e.getAttribute("index")||"0",10),a=[...this._renderedRows],c=a.filter((e=>this.selectedRows.find((t=>t===n(e))))).find((t=>l(e,t)));if(c)this._focusableRow=n(c);else{const t=a.find((t=>l(e,t)));this._focusableRow=t?n(t):0}}_updateColumnHeader(){const e=`${this.columnHeader.length}`.length;this.columnHeader.forEach(((t,s)=>{const o=s+1;switch(this.headerFormat){case"pad":t.index=`${o}`.padStart(e,"0");break;case"az":t.index=(e=>{const t="A".charCodeAt(0);let s="";do{e-=1,s=String.fromCharCode(t+e%26)+s,e=e/26|0}while(e>0);return s})(o);break;default:null==t.index&&(t.index=`${o}`)}}))}_updateColumnWidth(){if(this._root){const e=this.columnWidth;if("number"===typeof e&&e>9)return void this._setColumnWidth(e-1+"px");"auto"===e?this._setAutoColumnWidth():this._removeColumnWidth()}}_setAutoColumnWidth(){var e;if(!this._autoColumnWidth){const t=null===(e=this.parentElement)||void 0===e?void 0:e.getBoundingClientRect();t&&this._recalculateAutoColumnWidth(t.width)}this._autoColumnWidth&&this._autoColumnWidth>0?this._setColumnWidth(`${this._autoColumnWidth}px`):this._removeColumnWidth()}_updateColumnMinWidth(){this._root&&this._root.style.setProperty("--spreadsheet-column-min-width",`${this.columnMinWidth}px`)}_updateColumnMaxWidth(){this._root&&(this.columnMaxWidth?this._root.style.setProperty("--spreadsheet-column-max-width",`${this.columnMaxWidth}px`):this._root.style.removeProperty("--spreadsheet-column-max-width"))}_updateSortingState(){if(!this.clientSort){const{column:e,order:t}=this._sortingState,s=e+1;t!==a.Unset&&this._sortedData.sort(((o,l)=>{const i=this._valueGetter(o[s]),r=this._valueGetter(l[s]),n=this._getSortingFunction(e);return t===a.Ascending?n(i,r):n(r,i)}))}}_renderHeader(e){var t;const{virtualStartHtml:s,virtualEndHtml:l}=this._renderHtmlForColVirtual(e),r=this.bodyIndex?null:1,n=this.compact?o.qy`
                <${se.Icon.tag} size="normal" icon=${f.default}></${se.Icon.tag}>`:r,a=null===(t=this._sortedData[0])||void 0===t?void 0:t[0],c=this.selectedTable||this.selectedRows.includes(i),d=this.selectedTable||this.selectedRows.includes(a)&&this._getRenderedScrollbar().scrollTop<this._rowHeight(),h=o.qy`
            <${g.tag} class="${e}-h"
                                      index=-1
                                      secondary='${(0,o.JR)(!!this.compact||void 0)}'
                                      ?selected-cell-on-row=${(0,o.JR)(this._selectionManager.findSelectedCellForRow(i)>-1||void 0)}
                                      ?selected-row=${c}
                                      ?selected-row-below=${d}
                                      data-testid='col-index'
                                      @mousedown=${e=>this._onCellMouseDown(e,i,b)}
                                      @mouseenter=${e=>this._onCellMouseEnter(e,i,b)}
                                      @mouseleave=${e=>this._onColumnMouseLeave(e.target)}
            >
                ${n}
            </${g.tag}>
        `,u=this.columnHeader&&this.columnHeader.length>0,_=this._colsData(u?this.columnHeader:this._sortedData[0]||[]),p=u||this.compact?o.qy`
                      ${h} ${s}
                      ${(0,o.ux)(_,(e=>e.index),((t,s)=>this._colsRender(e,t,s,c,d,a)))}
                      ${l}
                  `:null,m=this.compact?null:o.qy`
                <div class="${e}-row" data-testid='row-header-0'
                >
                    <${g.tag} class="${e}-h"
                                              show-index
                                              index=-1
                                              @mouseenter=${e=>this._onCellMouseEnter(e,-2,-2)}
                                              @mouseleave=${e=>this._onColumnMouseLeave(e.target)}
                    >
                    </${g.tag}>
                    ${s}
                    ${(0,o.ux)(_,(e=>e.index),((t,s)=>this._colsRenderIndexRow(e,t,s)))}
                    ${l}
                </div>`;return o.qy` ${m}
            <div class="${e}-row" data-testid="row-header-1" @sort=${this._handleSort} index="-1">
                ${p}
            </div>`}async _onTableKeyDown(e){this._focusedColumn>b&&this.columnSelect?await this._doColumnKeyboardNavigation(e):this._focusedRow>b&&this.rowSelect?await this._doRowKeyboardNavigation(e):!$(this._focusedCell)&&this.cellSelect&&await this._doCellKeyboardNavigation(e)}_isDisabledCell(e,t){return void 0!==this.columnHeader[t]&&this.columnHeader[t].disabled||void 0!==this.disableCell&&e>i&&this.disableCell(e,t)}_isHiddenCell(e,t){return void 0!==this.hideCell&&this.hideCell(e,t)}_findNewRowIndex(e,t,s){const o=this._sortedData.findIndex((t=>t[0]===e)),l=this.compact||this.bodyIndex,i=t=>s?t():e;return o+t>this._dataRowLength()-1?i((()=>l?this._sortedData[0][0]:-1)):l||o+t!==-1?o+t<0?i((()=>this._sortedData[this._dataRowLength()-1][0])):this._sortedData[o+t][0]:-1}_renderRows(e){return(0,o.ux)(this._rowsData(),(e=>e[0]),((t,s)=>this._rowsRender(t,s,e)))}_renderColumnHeadExtra(e){return this.compact?null:o.qy` <slot name="column-head-${e}" slot="column-head"></slot>`}_getRowSelection(e,t){var s,o,l;const i=null!==(o=null===(s=this._sortedData[t-1])||void 0===s?void 0:s[0])&&void 0!==o?o:-1,r=null===(l=this._sortedData[t+1])||void 0===l?void 0:l[0],n=this.selectedRows?this.selectedRows.filter((e=>void 0!==e&&null!==e)):[],a=n.indexOf(e)>-1;return{selectedRow:a,firstSelectedRow:a&&!n.includes(i),lastSelectedRow:a&&!n.includes(r)}}_getColumnSelection(e){const t=this.selectedColumns.indexOf(e)>-1;return{selectedColumn:t,firstSelectedColumn:t&&!this.selectedColumns.includes(e-1),lastSelectedColumn:t&&!this.selectedColumns.includes(e+1)}}_getCellSelection(e,t){const s=this._selectionManager.selectedCellIndex([-1,e])>-1,o=s&&this._selectionManager.selectedCellIndex([-1,e+1])>-1,l=s&&this._selectionManager.selectedCellIndex([-1,e-1])>-1,i=s&&this._selectionManager.selectedCellIndex([t,e])>-1;return{selectedCell:s,selectedCellAfter:o,selectedCellBefore:l,selectedCellInColumn:this._selectionManager.findSelectedCellForColumn(e)>-1,selectedCellBelow:i}}_renderCell(e,t,s,l,i,r){let{realRowIndex:n,rowIndex:a,rowIndexBefore:c,rowIndexAfter:d}=i,{selectedRow:h,firstSelectedRow:u,lastSelectedRow:_,selectedRowAbove:p,selectedRowBelow:g}=r;var f;const{virtualStartHtml:m,virtualEndHtml:v}=this._renderHtmlForColVirtual(e),w=t.slice(1),[C,y]=(0,o.Yh)(`${e}-cell`,{"column-width":"auto"===this.columnWidth||this.columnWidth>9,"selected-row":this.selectedTable||h,"selected-row-above":this.selectedTable||p,"selected-row-below":this.selectedTable||g,"selected-first-row":u,"selected-last-row":this.selectedTable&&s||_,"selected-cell-on-row":this._selectionManager.findSelectedCellForRow(n)>-1,"row-last":s,"row-first":0===a,"drag-select":!!this._dragSelected&&this._dragSelected.contains([a,b])}),x=null!==(f=t.index)&&void 0!==f?f:this._getVisualRowIndex(a);return o.qy`
            <div
                class="${y} ${C}-index"
                @mousedown=${e=>this.rowSelect?this._onCellMouseDown(e,n,b):null}
                @mouseenter=${e=>this.rowSelect?this._onCellMouseEnter(e,n,b):null}
                @mouseleave=${e=>this.rowSelect?this._onHeaderCellMouseLeave(e.target):null}
                data-testid="index-r${n}"
            >
                <div class="${C}-index-color">
                    <div class="${C}-inner">${x}</div>
                </div>
            </div>
            ${m}
            ${(0,o.ux)(this._colsData(w),((e,s)=>{var i;const r=this._colsKey(s),{selectedColumn:u,firstSelectedColumn:_,lastSelectedColumn:p}=this._getColumnSelection(r),{selectedColumn:g}=this._getColumnSelection(r-1),{selectedColumn:f}=this._getColumnSelection(r+1),{selectedCellIndex:m,selectedCellIndexBefore:v,selectedCellIndexAfter:x,selectedCellIndexAbove:$,selectedCellIndexBelow:R}=this._getSelectedCells(n,r,h,u,c,d),{cellValue:k,cellState:M,cellPlaceholder:E,cellBold:T,cellItalic:I}=this._getCellValue(e),A=this.isEditingCell(n,r),O=this._isDisabledCell(n,r),H=this._renderInnerCell(C,k,E,r,n,A,{disabledCell:O,cellBold:T,cellItalic:I}),B=l||this._getBodyCellTextAlignFor(r),z=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="";return o=Object.keys(s).reduce(((t,o)=>s[o]?`${t} ${e}--${o}`:t),o).trim(),`${t}${o?" ":""}${o}`}(C,y,{"hover-column":this._hoverColumnEffect(r),"selected-column":u,"selected-column-prev":g,"selected-column-next":f,"selected-first-column":_,"selected-last-column":p,"selected-cell":m,"selected-cell-before":v,"selected-cell-after":x,"selected-cell-below":R,"selected-cell-above":$,"drag-select":this._dragSelected&&(this._dragSelected.contains([a,r])||this._dragSelected.contains([b,r])),"last-selected":S([n,r],this._lastSelectedCell),"column-first":0===r,"column-last":w.length-1===r,fail:M,editing:A,disabled:O,["align-"+B]:B});return o.qy` <div
                        class="${z}"
                        rIndex=${n}
                        cIndex=${r}
                        tabindex=${(0,o.JR)(this._getTabindexForCell(n,r))}
                        @mousedown=${e=>this._onCellMouseDown(e,n,r)}
                        @mouseenter=${e=>this._onCellMouseEnter(e,n,r)}
                        @mouseleave=${e=>this._onHeaderCellMouseLeave(e)}
                        @dblclick=${()=>this._onCellDblClick(n,r)}
                        @focus=${()=>this._onCellFocus([n,r])}
                        @blur=${()=>this._onCellBlur([n,r])}
                        style="${M?"":"--spreadsheet-cell-background-color:"+(null!==(i=t.backgroundColor)&&void 0!==i?i:this._getBodyCellBackgroundColorFor(n,r,k))}"
                        data-testid="cell-r${n}-c${r}"
                        role="cell"
                    >
                        ${H}
                    </div>`}))}
            ${v}
        `}_renderInnerCell(e,t,s,l,i,r,n){let{disabledCell:a,cellBold:c,cellItalic:d}=n;const h=this._controlType(i,l);if(this._isHiddenCell(i,l))return null;if("checkbox"===h.type)return this.renderEditCheckbox(e,i,l,t,a,this._onInputChange);if("select"===h.type)return this.renderEditSelect(e,i,l,t,h.choices,a,this._onInputChange);const u=!t&&s?s:this._formatCellValue(t,l),_=this.overflowTooltip?o.qy`<span>${u}</span>`:u;let p=null;if(!a&&r){const o=this._shouldUseFormatterOnEditFor(l)?u:t;p=this.renderEditInput(e,i,l,o,s,"number"===h.type,this._onInputChange,this._editCellKeydownHandler)}return o.qy` <div
                class="${e}-inner"
                style=${B({"--spreadsheet-row-font-weight":c?"600":void 0,"--spreadsheet-row-font-style":d?"italic":void 0})}
            >
                ${_}
            </div>
            ${p}`}_getCellWhenMouseEnter(e,t,s){return s?("row"===s.type?t=b:"column"===s.type?e=b:"cell"===s.type&&(e===b&&(e=s.to[0]),t===b&&(t=s.to[1])),[e,t]):null}async _scrollOnMouseEnter(e){const{_drag:t,_root:s}=this,[o,l]=e;if(l-t.to[1]!==0){const e=await A(s,`[class$="-col-index"][index="${Math.max(0,l)}"]`);this._scrollColumnIfNeeded(e,"smooth",16)&&(t.state="scroll",await new Promise((e=>setTimeout(e,100))),t.state=void 0)}if(o-t.to[0]!==0){const e=await A(s,`[class*="-row"][index="${o<0?Math.max(0,t.to[0]-1):o}"]`);this._scrollRowIfNeeded(e,"smooth",16)&&(t.state="long",await new Promise((e=>setTimeout(e,100))),t.state=void 0)}}_handleMouseMove(e,t,s){this._drag&&!this.singleSelect&&(e.preventDefault(),this._drag.drag=!0,this._dragSelected=new M([t,s]))}_handleMouseUp(e,t,s){this._drag&&(e.shiftKey?(this._shiftWhenMouseUp(t,s),E(e)):!this._drag.drag||!this._dragSelected||this._dragSelected.size()<=1?(this.dispatch("click",{row:t,column:s}),this._handleClickWhenMouseUp(e,t,s,this._drag)):this._dragSelected&&(this._dragWhenMouseUp(t,s),E(e)),this._dragSelected=void 0,this._drag=void 0)}_handleClickWhenMouseUp(e,t,s,o){t!==b&&s!==b?this.cellSelect?this._cellClickHandler(o.cell,o.include,t,s)&&E(e):this.rowSelect&&!this.columnSelect?(this._rowClickHandler(e,t),E(e)):this.columnSelect&&(this._columnClickHandler(e,s),E(e)):t===b&&s!==b?(this._columnClickHandler(e,s),E(e)):t!==b&&s===b&&(this._rowClickHandler(e,t),E(e))}_dragWhenMouseUp(e,t){const{_drag:s,_dragSelected:o}=this;s&&(e!==b&&t!==b?this._selectionManager.dragSelectCells(e,t,o,s.include):e===b&&t!==b?this._selectionManager.dragSelectColumns(t,o,s.include):e!==b&&t===b&&this._selectionManager.dragSelectRows(e,o,s.include))}_shiftWhenMouseUp(e,t){const{_drag:s}=this;if(s)if("cell"===s.type){const o=new M(S(this._lastSelectedCell,w)?[e,t]:this._lastSelectedCell,s.to);this._selectionManager.dragSelectCells(e,t,o,!0)}else if("column"===s.type&&this._lastSelectedColumn>b){const e=new M([b,this._lastSelectedColumn],s.to);this._selectionManager.dragSelectColumns(t,e,!0)}else if("row"===s.type&&this._lastSelectedRow>b){const t=new M([this._lastSelectedRow,b],s.to);this._selectionManager.dragSelectRows(e,t,!0)}}_updateSpanTitle(e){const t=U.getCellSpan(e.target);t&&t.getBoundingClientRect().width>e.target.getBoundingClientRect().width&&(e.target.title=t.innerText)}_getCellValue(e){var t,s;let o,l,i,r,n;if(e&&"object"===typeof e){const a=e;o=a.value,l=!!a.fail&&a.fail,i=a.placeholder?a.placeholder:"",r=null!==(t=a.bold)&&void 0!==t&&t,n=null!==(s=a.italic)&&void 0!==s&&s}else o=e,l=!1,i="",r=!1,n=!1;return{cellValue:o,cellState:l,cellPlaceholder:i,cellBold:r,cellItalic:n}}_dispatchChangeEvent(e){return e&&e.length>0&&this.dispatch(c.Change,1===e.length?{value:e[0].value,rowIndex:e[0].rowIndex,columnIndex:e[0].columnIndex}:e,this,(()=>{this.editInPlace&&this._commitChanges(e)}),(()=>{})),e}_commitChanges(e){e.forEach((e=>{let{rowIndex:t,columnIndex:s,value:o}=e;if(t>i){const e=this.data[t][s];null!==e&&"object"===typeof e?(e.value=o,this.data[t][s]=e,this._sortedData[t][s+1]=e):(this.data[t][s]=o,this._sortedData[t][s+1]=o)}else t===i&&(this.columnHeader[s].title=o)}))}_shouldUseFormatterOnEditFor(e){var t,s;return(null===(s=null===(t=this.columnHeader)||void 0===t?void 0:t[e])||void 0===s?void 0:s.useFormatterOnEdit)||!1}_updateInitialSort(){var e;if(this.initialSort){this._sortingState=this.initialSort;const t=null===(e=this._headerNodes)||void 0===e?void 0:e[this._sortingState.column];t&&(t.sortOrder=this._sortingState.order)}}_handleSort(e){var t;this.clientSort||(this._sortingState=e.detail.value,null===(t=this._headerNodes)||void 0===t||t.map((e=>{e.index!==this._sortingState.column&&(e.sortOrder=a.Unset)})))}_columnClickHandler(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b;e.stopPropagation(),this._selectionManager.columnSelect(t<0?e.detail.value.column:t,{unselect:t<0?e.detail.value.ctrlKey||e.detail.value.metaKey:e.ctrlKey||e.metaKey,byMouse:!0}),this._scrollColumnIfNeeded(U.getColumn(this._root,t))}_rowClickHandler(e,t){e.stopPropagation(),this._selectionManager.rowSelect(t,{unselect:e.ctrlKey||e.metaKey,byMouse:!0}),this._scrollRowIfNeeded(U.getRow(this._root,t))}_cellClickHandler(e,t,s,o){return!(S(this.getEditing(),[s,o])||!t&&!this.singleSelect&&S(this._lastSelectedCell,[s,o]))&&(this._selectionManager.cellSelect(s,o,{unselect:t,byMouse:!0}),s>i&&this._scrollCellIfNeeded(e.closest('[class*="-cell-root"]')),e.style.setProperty("animation-name","visual-bell-ok"),setTimeout((()=>e.style.removeProperty("animation-name")),500),!0)}_scrollColumnIfNeeded(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this._getRenderedScrollbar(),l=this._findScrollLeftWhenOutside(e,o,s);return void 0!==l&&(o.scrollTo({left:l,behavior:t}),!0)}_scrollRowIfNeeded(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"smooth",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e){const o=this._getRenderedScrollbar(),l=this._findScrollTopWhenOutside(e,o,s);if(void 0!==l)return o.scrollTo({top:l,behavior:t}),!0}return!1}_scrollCellIfNeeded(e){const t=this._getRenderedScrollbar(),s=e.closest('[class*="-bodyrow"]'),o=this._findScrollTopWhenOutside(s,t),l=this._findScrollLeftWhenOutside(e,t);(o||l)&&t.scrollTo({top:o,left:l,behavior:"smooth"})}_findScrollLeftWhenOutside(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this._getStickyColumnWidth(),{offsetLeft:l,clientWidth:i}=e,{scrollLeft:r,clientWidth:n}=t,a=l-o-r,c=n-(l+i)+r;let d;return a<s?d=r+(a-1)-s:c<s&&(d=r-(c-2)+s),d}_findScrollTopWhenOutside(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const o=this._getStickyHeaderHeight(),{offsetTop:l,clientHeight:i}=e,{scrollTop:r,clientHeight:n}=t,a=l-o-r,c=n-(l+i)+r;let d;return a<0?d=r+(a-1)-s:c<0&&(d=r-(c-2)+s),d}_scrollHelper(e,t){this._getRenderedScrollbar().scrollBy(Object.assign(Object.assign({},t),{behavior:"auto"})),E(e)}};ie.PRIMARY_HEADER_SLOT="header-row-1",ie.SECONDARY_HEADER_SLOT="header-row-2",ie.VIRTUALIZATION_MIN_COL_LEN=30,ie.VIRTUALIZATION_MIN_ROW_LEN=30,ie.NORMAL_ROW_HEIGHT=32,ie.COMPACT_ROW_HEIGHT=24,oe([(0,o.MZ)({attribute:"initial-sort"}),le("design:type",Object)],ie.prototype,"initialSort",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,attribute:"column-select",converter:o.Bs}),le("design:type",Object)],ie.prototype,"columnSelect",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,attribute:"row-select",converter:o.Bs}),le("design:type",Object)],ie.prototype,"rowSelect",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,attribute:"cell-select",converter:o.Bs}),le("design:type",Object)],ie.prototype,"cellSelect",void 0),oe([(0,o.MZ)({type:Boolean,attribute:"single-select",converter:o.Bs}),le("design:type",Object)],ie.prototype,"singleSelect",void 0),oe([(0,o.MZ)({type:Boolean,attribute:"multi-type-select",converter:o.Bs}),le("design:type",Object)],ie.prototype,"multiTypeSelect",void 0),oe([(0,o.MZ)({type:Boolean,attribute:"body-index",converter:o.Bs}),le("design:type",Object)],ie.prototype,"bodyIndex",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),le("design:type",Object)],ie.prototype,"compact",void 0),oe([(0,o.MZ)({type:Boolean,attribute:"hover-effects",reflect:!0,converter:o.Bs}),le("design:type",Object)],ie.prototype,"hoverEffects",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),le("design:type",Object)],ie.prototype,"overflowTooltip",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),le("design:type",Object)],ie.prototype,"menu",void 0),oe([(0,o.MZ)({type:Number,reflect:!1,attribute:"row-buffer"}),le("design:type",Object)],ie.prototype,"rowBuffer",void 0),oe([(0,o.MZ)({type:Number,reflect:!1,attribute:"col-buffer"}),le("design:type",Object)],ie.prototype,"colBuffer",void 0),oe([(0,o.MZ)({type:Number,reflect:!0,attribute:"column-width"}),le("design:type",Object)],ie.prototype,"columnWidth",void 0),oe([(0,o.MZ)({type:Number,reflect:!0,attribute:"column-min-width"}),le("design:type",Object)],ie.prototype,"columnMinWidth",void 0),oe([(0,o.MZ)({type:Number,reflect:!0,attribute:"column-max-width"}),le("design:type",Object)],ie.prototype,"columnMaxWidth",void 0),oe([(0,o.MZ)({type:Array(),reflect:!1,converter:function(e){let t=e;return"string"===typeof e&&(t=JSON.parse(e)),Array.isArray(t)?Array.isArray(t[0])?t:[t]:e}}),le("design:type",Array)],ie.prototype,"data",void 0),oe([(0,o.MZ)({type:Array(),reflect:!1}),le("design:type",Array)],ie.prototype,"columnHeader",void 0),oe([(0,o.MZ)({type:Array(),reflect:!1}),le("design:type",Array)],ie.prototype,"rowExtra",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"control",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"colorColumn",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"colorRow",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"colorCell",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"disableCell",void 0),oe([(0,o.MZ)({type:Function,reflect:!1}),le("design:type",Function)],ie.prototype,"hideCell",void 0),oe([(0,o.MZ)({type:Number,attribute:"decimals",reflect:!0}),le("design:type",Object)],ie.prototype,"decimals",void 0),oe([(0,o.MZ)({type:String,attribute:"header-format"}),le("design:type",String)],ie.prototype,"headerFormat",void 0),oe([(0,o.MZ)({attribute:"selected-table",type:Boolean,reflect:!1,converter:o.Bs}),le("design:type",Object)],ie.prototype,"selectedTable",void 0),oe([(0,o.MZ)({attribute:"selected-rows",reflect:!1,converter:o.$z}),le("design:type",Array)],ie.prototype,"selectedRows",void 0),oe([(0,o.MZ)({attribute:"selected-columns",reflect:!1,converter:o.$z}),le("design:type",Array)],ie.prototype,"selectedColumns",void 0),oe([(0,o.MZ)({attribute:"selected-cells",reflect:!1,converter:o.$z}),le("design:type",Array)],ie.prototype,"selectedCells",void 0),oe([(0,o.MZ)({type:Boolean,reflect:!0,converter:o.Bs}),le("design:type",Object)],ie.prototype,"editInPlace",void 0),oe([(0,o.MZ)({attribute:"client-sort",type:Boolean,reflect:!1,converter:o.Bs}),le("design:type",Object)],ie.prototype,"clientSort",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_hoverCell",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_sortingState",void 0),oe([(0,o.wk)(),le("design:type",Array)],ie.prototype,"_sortedData",void 0),oe([(0,o.P)("div"),le("design:type",Object)],ie.prototype,"_root",void 0),oe([(0,o.P)('[class$="-body"]'),le("design:type",Object)],ie.prototype,"_body",void 0),oe([(0,o.YG)('[class$="-col-index"]'),le("design:type",Object)],ie.prototype,"_renderedCols",void 0),oe([(0,o.YG)('[class$="-bodyrow"]'),le("design:type",Object)],ie.prototype,"_renderedRows",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_focusedColumn",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_focusableColumn",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_focusedRow",void 0),oe([(0,o.wk)(),le("design:type",Object)],ie.prototype,"_focusableRow",void 0),oe([(0,o.wk)(),le("design:type",Array)],ie.prototype,"_focusedCell",void 0),oe([(0,o.wk)(),le("design:type",Array)],ie.prototype,"_focusableCell",void 0),oe([(0,o.wk)(),le("design:type",M)],ie.prototype,"_dragSelected",void 0),ie=se=oe([(0,o.eV)({tagName:"spreadsheet",styles:e=>[(()=>{const{root:t,child:s,is:l}=(0,o.zz)(e);return o.AH`:host,:host::before,:host::after,:host *,:host *::before,:host *::after{box-sizing:border-box;}:host{display:block;width:100%;height:100%;white-space:nowrap;text-overflow:ellipsis;--select-min-width:100%;--spreadsheet-selection-color:#00000010;--spreadsheet-border-color:var(--color-secondary-3);--spreadsheet-cell-fail-color:rgba(235, 2, 78, 0.05);--spreadsheet-index-color:var(--color-secondary-8);--spreadsheet-selection-index-bg-color:var(--color-secondary-3);--spreadsheet-full-selection-index-bg-color:var(--color-secondary-6);--spreadsheet-full-selection-index-fg-color:var(--color-primary-2);--spreadsheet-row-height:32px;--spreadsheet-font-size:16px;}:host([compact]){--spreadsheet-row-height:24px;--spreadsheet-font-size:13px;}${t}{display:block;height:100%;width:100%;user-select:none;outline:0;}${s("scroll")}{overflow:auto;max-height:100%;}${s("table")}{display:table;width:100%;text-align:end;}${s("head")}{display:table-header-group;position:sticky;z-index:4;top:0;background-color:${(0,o.b7)("color_primary_2")};}${s("col-title")}{background:var(--spreadsheet-cell-background-color, none);}${s("body")}{display:table-row-group;}${s("row")}{display:table-row;}${s("bodyrow")}{height:var(--spreadsheet-row-height);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;position:relative;outline:0;background:var(--spreadsheet-row-background-color, initial);}${s("bodyrow")}:focus-visible:after{content:'';position:absolute;outline:2px solid black;inset:0;outline-offset:-2px;z-index:3;}:host([row-select]) ${l("hover-effects")} ${s("bodyrow")}:hover{background-color:#0000001a;cursor:pointer;}:host([row-select]) ${l("hover-effects")} ${s("bodyrow")}:hover ${s("cell-index")}{background-color:#cecece;cursor:pointer;}${s("start-row")}{display:table-row;height:var(--extra-row-start-height, 0);min-height:0;line-height:0;white-space:nowrap;}${s("end-row")}{display:table-row;height:var(--extra-row-end-height, 0);min-height:0;line-height:0;white-space:nowrap;}${s("padding-cell")}{display:table-cell;height:0;min-height:0;visibility:hidden;overflow:hidden;font-size:var(--spreadsheet-font-size);padding:0 9px;position:relative;}${s("padding-cell")}:before{counter-reset:padding-cell-content var(--padding-cell-content);content:counter(padding-cell-content);visibility:hidden;display:block;height:0;overflow:hidden;white-space:nowrap;}${s("start-col")}{display:table-cell;min-width:var(--extra-col-start-width, 0);width:0;}${s("end-col")}{display:table-cell;min-width:var(--extra-col-end-width, 0);background:white;}${s("h")}{color:var(--spreadsheet-index-color);position:sticky;left:0;z-index:2;border-right:1px solid var(--spreadsheet-selection-index-bg-color);}.dragover{position:relative;}.dragover:after{content:'';position:absolute;background-color:#00000025;z-index:5;}.dragdown:after{inset:calc(100% - 6px) 0px -5px;}.dragup:after{inset:-6px 0px calc(100% - 5px);}`})(),(()=>{const{root:t,child:s,is:l}=(0,o.zz)(e+"-cell");return o.AH`${t}{display:table-cell;border-left:1px solid var(--spreadsheet-border-color);border-bottom:1px solid var(--spreadsheet-border-color);font-size:var(--spreadsheet-font-size);position:relative;vertical-align:middle;background:var(--spreadsheet-cell-background-color, none);max-width:var(--spreadsheet-column-max-width, initial);outline:0;}${t}:focus-visible:after{content:'';position:absolute;outline:2px solid black;inset:0;outline-offset:-2px;z-index:3;}${l("fail")}{--spreadsheet-cell-background-color:var(--spreadsheet-cell-fail-color);}${s("index")}{text-align:start;color:var(--spreadsheet-index-color);position:sticky;left:0;z-index:2;background:${(0,o.b7)("color_secondary_1")};border-right:1px solid var(--spreadsheet-border-color);border-left:0;}${s("index-color")}{width:100%;height:calc(var(--spreadsheet-row-height, 32px) - 1px);background:var(--spreadsheet-row-background-color, transparent);padding-top:2px;}:host([compact]) ${s("index-color")}{padding-top:0;}${l("disabled")} ${s("inner")}{color:${(0,o.b7)("color_secondary_4")};}${s("inner")}{overflow:hidden;text-overflow:ellipsis;padding:4px 8px;pointer-events:none;}${t}:not(${s("index")}) > ${s("inner")}{color:var(--spreadsheet-row-font-color, currentColor);font-weight:var(--spreadsheet-row-font-weight, normal);font-style:var(--spreadsheet-row-font-style, normal);}${l("editing")} ${s("inner")}{visibility:hidden;}${s("edit")}{width:100%;height:100%;background:transparent;border:0;outline:0;position:absolute;inset:-1px;text-align:right;padding:2px 7px 0 0;font-size:var(--spreadsheet-font-size);font-family:Roboto, Arial, 'Open Sans', Helvetica, 'sans-serif';}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0;}input[type='number']{-moz-appearance:textfield;}${l("align-left")} ${s("edit")}{text-align:left;padding:2px 2px 0 9px;}${s("select")}{outline:0;background-color:transparent;font-size:var(--spreadsheet-font-size);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;}${s("checkbox")}{outline:0;}${t}:nth-of-type(3){border-left:1px solid transparent;}${l("column-width")}{max-width:0;}${l("selected-row")}:after{content:' ';display:block;position:absolute;pointer-events:none;box-sizing:border-box;inset:-1px;z-index:1;background-color:var(--spreadsheet-selection-color);}${l("row-first","selected-row")}:after{top:0;}${l("selected-last-row","!selected-column","!selected-cell-below")}:not(${s("index")}):after{border-bottom:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-first-row","!selected-column","!selected-cell-above")}:not(${s("index")}):after{border-top:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-row")}${s("index")}:after{border:0;}${l("selected-row")}:last-of-type:after{content:' ';display:block;position:absolute;border-right:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-column")}:after{content:' ';display:block;position:absolute;pointer-events:none;z-index:1;inset:-1px;background-color:var(--spreadsheet-selection-color);}${l("selected-column","row-last")}:after{border-bottom:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-last-column","!selected-row","!selected-cell-after")}:after{border-right:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-first-column","!selected-row","!selected-cell-before")}:after{border-left:1px solid ${(0,o.b7)("color_secondary_10")};}:host(:is([hover-effects], [compact])[cell-select]) ${t}:hover{background-color:#0000001a;cursor:pointer;}:host(:is([hover-effects], [compact])[cell-select]:not([row-select])) ${s("index")}:hover{background-color:${(0,o.b7)("color_secondary_1")};cursor:initial;}:host([column-select]) ${l("hover-column")}{background-color:#0000001a;}${l("selected-row")}${s("index")}{background-color:var(--spreadsheet-full-selection-index-bg-color);color:var(--spreadsheet-full-selection-index-fg-color);z-index:3;border-bottom:1px solid var(--spreadsheet-selection-index-bg-color);border-right:1px solid var(--spreadsheet-selection-index-bg-color);}${l("selected-cell-on-row")}${s("index")}{background-color:var(--spreadsheet-selection-index-bg-color);}${l("drag-select")} ${s("index")}{background-color:#00000020;}${l("column-last")}{border-right:1px solid var(--spreadsheet-border-color);}${l("selected-row")}${l("column-last")}:after{border-right:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-row")}${l("column-first")}:after{border-left:1px solid ${(0,o.b7)("color_secondary_10")};}[drag-select]{animation:pulse-animation 0.25s;background-color:#00000020;}${l("selected-cell")}:after{content:' ';display:block;position:absolute;pointer-events:none;inset:-1px;z-index:1;background-color:var(--spreadsheet-selection-color);}${l("last-selected")}:after{background-color:unset;}${l("drag-select")}:after{content:' ';display:block;position:absolute;pointer-events:none;inset:-1px;z-index:1;animation:pulse-animation 0.25s;background-color:#00000020;}@keyframes pulse-animation{0%{background-color:#00000040;}100%{background-color:#00000020;}}@keyframes visual-bell-ok{from{background-color:var(--color-secondary-8);}to{background-color:var(--spreadsheet-cell-background-color, transparent);}}.visual-bell{animation-name:visual-bell-fail;animation-duration:0.5s;}@keyframes visual-bell-fail{from{background-color:#e6004699;}to{background-color:transparent;}}${l("row-first","selected-cell")}:after{top:0;}${l("row-last","selected-row")}:after{bottom:0;}${l("align-left")}{text-align:left;}${l("align-center")}{text-align:center;}${l("selected-cell","!selected-cell-before","!selected-column-prev","!last-selected")}:after{border-left:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-cell","!selected-cell-after","!selected-column-next","!last-selected")}:after{border-right:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-cell","!selected-cell-above","!selected-row-above","!last-selected")}:after{border-top:1px solid ${(0,o.b7)("color_secondary_10")};}${l("selected-cell","!selected-cell-below","!selected-row-below","!last-selected")}:after{border-bottom:1px solid ${(0,o.b7)("color_secondary_10")};}${l("last-selected")}:after{border:2px solid ${(0,o.b7)("color_secondary_10")};}${l("editing")}:after{box-shadow:0 0 3px 3px rgba(0, 0, 0, 0.2);}select{width:100%;height:calc(var(--spreadsheet-row-height, 32px) - 1px);border:0;}select *{color:black;}`})()],version:n}),le("design:paramtypes",[])],ie)},45901:(e,t,s)=>{s.d(t,{wC:()=>i});const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return o=>{if(null===o||void 0===o||isNaN(o))return"";if(0===o)return"0";if(((e,t,s)=>{const o=Math.pow(10,t),l=Math.pow(10,-e);return Math.abs(s)<=l||Math.abs(s)>=o})(t,s,o)){const t=(e=>{let t=0;for(let s=0,o=(e=e.toExponential()).length;s<o&&"e"!==e[s];s++)+e[s]>=0&&t++;return t})(o);return t<=e?o.toExponential(t-1):o.toExponential(e-1)}return((e,t)=>parseFloat(e.toPrecision(t)).toString())(o,e)}},l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return l=>"number"===typeof l?o(e,t,s)(l):(e=>null===e||void 0===e?"":String(e))(l)},i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6;return o=>l(e,t,s)(o)}},52562:(e,t,s)=>{s.r(t),s.d(t,{default:()=>o});const o=(0,s(80129).p)({name:"sort",data:'<svg fill="currentColor" viewBox="0 0 22 25"><path d="M4 8.5V7h13.798v1.5zM4 13v-1.5h10.2V13zm0 4.5V16h6.6v1.5z"/></svg>'})},80129:(e,t,s)=>{s.d(t,{m:()=>n,p:()=>r});var o=s(93656);let l;const i=()=>{if(!l){let e=window.studio;e||(e=window.studio={});let t=e.sui;t||(t=e.sui={});const s=`icons${o.r.split(".")[0]||o.r}`;l=l||t[s],l||(l=t[s]={})}return l},r=e=>{const t=i();return t[e.name]||(t[e.name]=e.data),e.name},n=e=>i()[e]},93656:(e,t,s)=>{s.d(t,{r:()=>o});const o="2.0.90"}}]);
//# sourceMappingURL=5376.9618d22d.chunk.js.map